---
tags:
  - lab
  - ctf
  - red_team
  - IIS
  - msfconsole
  - nmap
  - T1078
  - T1109
  - T1059_005
  - T1107_001
  - T1105
  - T1136_008
module: Host and Networking Penetration Test
topic: System and Host Based Attacks
date: 2025-10-23
status: completed
---
# Objective

Exploit the WebDAV service and retrieve the flag!

**The following username and password may be used to access the service:**

| Username | Password | | bob | password_123321 |

# Walkthrough

- Ran `ifconfig` and `ping -c 1 demo.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines aren't in the same subnet

	  <img width="899" height="421" alt="1-1  Windows IIS Server WebDav Metasploit ifconfig" src="https://github.com/user-attachments/assets/c46acb45-9c3b-4f0f-8f01-1a150c0f89e2" />
   	  <img width="958" height="214" alt="1-1  Windows IIS Server WebDav Metasploit ping" src="https://github.com/user-attachments/assets/6906630e-5fc9-420d-a542-77156cbd526a" />

- Conduct a port and service scan with nmap, `nmap -Pn -sS -sV -O -p 80,443 --script=http-enum demo.ine.local -T4 -oX target.xml`

  <img width="1249" height="753" alt="1-1  Windows IIS Server WebDav Metasploit nmap" src="https://github.com/user-attachments/assets/cfeb68fb-6831-468f-aaeb-66ff64f75a52" />

- Launch and set up msfconsole initially.

  <img width="975" height="634" alt="1-1  Windows IIS Server WebDav Metasploit msfconsole setup" src="https://github.com/user-attachments/assets/c15931a7-bf28-4334-8d6a-fc4b72568033" />

- Use `davtest` to do a webdav scan first, `davtest -url http://demo.ine.local/webdav/ -auth bob:password_123321`

  <img width="1335" height="743" alt="1-1  Windows IIS Server WebDav Metasploit davtest 1" src="https://github.com/user-attachments/assets/6b12794d-cca2-450b-942b-b9885e1b02ee" />
  <img width="1337" height="706" alt="1-1  Windows IIS Server WebDav Metasploit davtest 2" src="https://github.com/user-attachments/assets/93341302-e455-4250-abed-a31d34b7477a" />

- Now we know what type of file can be uploaded and executed on the site. Now we use `exploit/windows/iis/iis_webdav_upload_asp` to exploit it.

  <img width="1235" height="445" alt="1-1  Windows IIS Server WebDav Metasploit upload shell" src="https://github.com/user-attachments/assets/ccb248b6-9603-4452-a870-ff1150681b39" />

- We get shell though the session created and obtain the flag

  <img width="850" height="640" alt="1-1  Windows IIS Server WebDav Metasploit shell" src="https://github.com/user-attachments/assets/4cee9124-6d3b-4269-873f-d01fdc5d5768" />
  <img width="580" height="111" alt="1-1  Windows IIS Server WebDav Metasploit flag" src="https://github.com/user-attachments/assets/8393bfd4-c492-4b8d-a312-d79f1f4a11a0" />

# Key Finds

- FLAG d3aff16a801b4b7d36b4da1094bee345
