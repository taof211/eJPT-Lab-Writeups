---
tags:
  - lab
  - ctf
  - red_team
  - IIS
  - msfconsole
  - nmap
  - T1078
  - T1109
  - T1059_005
  - T1107_001
  - T1105
  - T1136_008
module: Host and Networking Penetration Test
topic: System and Host Based Attacks
date: 2025-10-23
status: completed
---
# Objective

Exploit the WebDAV service and retrieve the flag!

**The following username and password may be used to access the service:**

| Username | Password | | bob | password_123321 |

# Walkthrough

- Ran `ifconfig` and `ping -c 1 demo.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines aren't in the same subnet
	![[1-1. Windows IIS Server WebDav Metasploit ifconfig.png]]
	![[1-1. Windows IIS Server WebDav Metasploit ping.png]]
- Conduct a port and service scan with nmap, `nmap -Pn -sS -sV -O -p 80,443 --script=http-enum demo.ine.local -T4 -oX target.xml`
  ![[1-1. Windows IIS Server WebDav Metasploit nmap.png]]
- Launch and set up msfconsole initially.
  ![[1-1. Windows IIS Server WebDav Metasploit msfconsole setup.png]]
- Use `davtest` to do a webdav scan first, `davtest -url http://demo.ine.local/webdav/ -auth bob:password_123321`
  ![[1-1. Windows IIS Server WebDav Metasploit davtest 1.png]]
  ![[1-1. Windows IIS Server WebDav Metasploit davtest 2.png]]
- Now we know what type of file can be uploaded and executed on the site. Now we use `exploit/windows/iis/iis_webdav_upload_asp` to exploit it.
  ![[1-1. Windows IIS Server WebDav Metasploit upload shell.png]]
- We get shell though the session created and obtain the flag
  ![[1-1. Windows IIS Server WebDav Metasploit shell.png]]
  ![[1-1. Windows IIS Server WebDav Metasploit flag.png]]

# Key Finds

- FLAG d3aff16a801b4b7d36b4da1094bee345