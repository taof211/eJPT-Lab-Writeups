---
tags:
  - lab
  - red_team
  - msfconsole
module: Host and Networking Penetration Test
topic: System and Host Based Attacks
date: 2025-10-27
status: completed
---
# Objective

Exploit the application and find all the flags:

- Find Administrator and Student users NTLM hash.
- Dump LSA secrets to find Syskey

# Walkthrough

- Ran `ifconfig` and `ping -c 1 demo.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines aren't in the same subnet

    <img width="871" height="418" alt="1-8  Windows Meterpreter Kiwi Extensionret ifconfig" src="https://github.com/user-attachments/assets/627f9eb6-73a4-4baa-98dd-43d220e7cd0e" />
    <img width="919" height="209" alt="1-8  Windows Meterpreter Kiwi Extensionret ping" src="https://github.com/user-attachments/assets/4ea1331c-1a6f-40a2-b551-f937b985ead0" />

- Conduct a nmap scan on the target host, `nmap -A -T4 -p- demo.ine.local -oX victim.xml`

  <img width="1165" height="722" alt="1-8  Windows Meterpreter Kiwi Extensionret nmao" src="https://github.com/user-attachments/assets/7f7ccaa5-d09f-4218-a89b-93ba548eeec9" />

- Launch msfconsole and initially set it up

  <img width="1046" height="692" alt="1-8  Windows Meterpreter Kiwi Extension msf setup 1" src="https://github.com/user-attachments/assets/0e800d07-a124-477c-9b8e-3cebdc48ea13" />
  <img width="1042" height="650" alt="1-8  Windows Meterpreter Kiwi Extension msf setup2" src="https://github.com/user-attachments/assets/267d0920-6bc4-48a2-8cd2-c07785478471" />

- Use `exploit/windows/http/badblue_passthru` module to exploit the service running on port 80. After session is created, migrate to lsass

  <img width="615" height="126" alt="1-8  Windows Meterpreter Kiwi Extension migrate" src="https://github.com/user-attachments/assets/c3882887-508b-45de-8856-29cf021c20b7" />

- Load kiwi

  <img width="928" height="271" alt="1-8  Windows Meterpreter Kiwi Extension kiwi" src="https://github.com/user-attachments/assets/1cbe4bb5-1840-4f27-89fd-2883c01ba084" />

- Dump the all credentials

  <img width="1373" height="668" alt="1-8  Windows Meterpreter Kiwi Extension creds" src="https://github.com/user-attachments/assets/26b7c059-3e9f-46e0-904f-c7a1a5b145cb" />

- Dump LSA SAM

  <img width="1275" height="667" alt="1-8  Windows Meterpreter Kiwi Extension sam 1" src="https://github.com/user-attachments/assets/9ba6b71c-43f3-4687-af82-ee554aa5ea4d" />
  <img width="1252" height="719" alt="1-8  Windows Meterpreter Kiwi Extension sam 2" src="https://github.com/user-attachments/assets/def113e3-d752-4179-907a-7253aa540037" />

# Key Finds

- Administrator NTLM Hash: e3c61a68f1b89ee6c8ba9507378dc88d
- student NTLM Hash: bd4ca1fbe028f3c5066467a7f6a73b0b
- SysKey: 377af0de68bdc918d22c57a263d38326
