---
tags:
  - lab
  - red_team
  - WinRM
  - brute_force
  - msfconsole
module: Host and Networking Penetration Test
topic: System and Host Based Attacks
date: 2025-10-25
status: completed
---
# Objective

Exploit the WinRM service to get a meterpreter on the target and retrieve the flag!

# Walkthrough

- Ran `ifconfig` and `ping -c 1 demo.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines aren't in the same subnet

    <img width="907" height="464" alt="1-4  WinRM Exploit with Metasploit ifconfig" src="https://github.com/user-attachments/assets/07d166ca-4856-4879-ac00-fbaa3774c6cf" />
    <img width="922" height="253" alt="1-4  WinRM Exploit with Metasploit ping" src="https://github.com/user-attachments/assets/346afd37-062e-491e-ad24-d26f91c3460d" />

- Conduct a port and service scan with nmap

  <img width="1150" height="662" alt="1-4  WinRM Exploit with Metasploit nmap" src="https://github.com/user-attachments/assets/a6f0b747-2b9a-4c09-a4b5-0bfa49192a7f" />

- Launch and initially set up msfconsole

  <img width="693" height="236" alt="1-4  WinRM Exploit with Metasploit msf setup" src="https://github.com/user-attachments/assets/4172b7eb-664c-4e38-9330-042609824fd5" />

- Use `auxiliary/scanner/winrm/winrm_auth_methods` module to check the allowed authentication method on the target host first.

  <img width="833" height="164" alt="1-4  WinRM Exploit with Metasploit auths" src="https://github.com/user-attachments/assets/0e9a4f76-138d-4403-a6cb-dbe28fbc0e80" />

- As the negotiate (NTLM) protocol supported, next we use `auxiliary/scanner/winrm/winrm_login` module to do brute forcing target the WinRM service

  <img width="1485" height="718" alt="1-4  WinRM Exploit with Metasploit login" src="https://github.com/user-attachments/assets/c6ca8670-15a3-4adb-9b6d-a11e95f2d7a9" />

- Get cmd shell through the established session

  <img width="769" height="241" alt="1-4  WinRM Exploit with Metasploit shell" src="https://github.com/user-attachments/assets/5843a5ef-2508-4cb4-a4c7-5af23b8af1be" />

- Find the flag in the file system

  <img width="832" height="656" alt="1-4  WinRM Exploit with Metasploit flag" src="https://github.com/user-attachments/assets/39337b94-ad07-4ab6-b539-b56ddafd34f0" />

# Key Finds

- FLAG 3c716f95616eec677a7078f92657a230
