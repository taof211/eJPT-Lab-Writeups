---
tags:
  - lab
  - red_team
  - linux
  - suid
module: Host and Networking Penetration Test
topic: System and Host Based Attacks
date: 2025-10-31
status: in-progress
---
# Objective

Your task is to

1. Get a root shell on the system
2. View /etc/shadow
3. Retrieve the flag.

# Walkthrough

- We entered the target Linux host with student account, and found two files in our home directory, where we have `s` and `x` permissions on the file `welcome`

  <img width="1476" height="395" alt="1-13  Exploit Setuid Programs files" src="https://github.com/user-attachments/assets/c550f8b6-7dd9-4ef2-a5f9-36fdf9af3132" />

- We can execute `welcome`, and when we use `strings` command to print the string in the binary, we can find `greetings`, which might mean the other binary `greeting` was invoked and executed by `welcome`

  <img width="838" height="676" alt="1-13  Exploit Setuid Programs greetings" src="https://github.com/user-attachments/assets/dfac68ef-3e82-4f02-a927-5cb83744e0d8" />

- So we replace the `greetings` with `/bin/bash`, but gave it the same name. Run `welcome` again, and now we got the root permission on the target host

  <img width="691" height="226" alt="1-13  Exploit Setuid Programs root" src="https://github.com/user-attachments/assets/7630be39-470b-459e-ace2-5ffc29e57248" />

- View `shadow` file

  <img width="887" height="535" alt="1-13  Exploit Setuid Programs shadow" src="https://github.com/user-attachments/assets/c7159fb5-c670-4057-9ef9-7eca5b7bd64f" />

- Get the flag

  <img width="486" height="158" alt="1-13  Exploit Setuid Programs flag" src="https://github.com/user-attachments/assets/4858352f-c73b-4229-b7eb-4a6390e05f68" />

# Key Finds

- FLAG b92bcdc876d52108778e2d81f3b01494
