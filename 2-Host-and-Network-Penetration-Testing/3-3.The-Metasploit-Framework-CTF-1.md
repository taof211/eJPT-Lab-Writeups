---
tags:
  - lab
  - ctf
  - red_team
  - msfconsole
module: Host and Networking Penetration Test
topic: The Metasploit Framework
date: 2025-11-04
status: completed
---
# Objective

Use Metasploit and manual investigation techniques to capture the following flags:

- **Flag 1:** Gain access to the MSSQLSERVER account on the target machine to retrieve the first flag.
- **Flag 2:** Locate the second flag within the Windows configuration folder.
- **Flag 3:** The third flag is also hidden within the system directory. Find it to uncover a hint for accessing the final flag.
- **Flag 4:** Investigate the Administrator directory to find the fourth flag.

# Walkthrough

- Ran `ifconfig` and `ping -c 1 target.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines aren't not in the same subnet

    <img width="932" height="423" alt="3-3  The Metasploit Framework CTF 1 ifconfig" src="https://github.com/user-attachments/assets/c7de152b-68f7-4ded-80ec-e9cac93f419c" />
    <img width="948" height="229" alt="3-3  The Metasploit Framework CTF 1 ping" src="https://github.com/user-attachments/assets/e91d2ada-6074-4c2a-ae6d-00d7a91f4415" />

- Conduct an nmap scan

  <img width="1086" height="714" alt="3-3  The Metasploit Framework CTF 1 nmap 1" src="https://github.com/user-attachments/assets/03204adb-2d62-4a12-acc9-158151c52be5" />
  <img width="1205" height="724" alt="3-3  The Metasploit Framework CTF 1 nmap 2" src="https://github.com/user-attachments/assets/f1294645-99b3-42af-8d2d-e7dfd76efa2e" />
  <img width="1233" height="604" alt="3-3  The Metasploit Framework CTF 1 nmap 3" src="https://github.com/user-attachments/assets/a4624ac2-7249-48c0-bfd6-bcdf1ac5c6d5" />

- Launch and set up msfconsole

  <img width="697" height="492" alt="3-3  The Metasploit Framework CTF 1 msf setup" src="https://github.com/user-attachments/assets/9b179404-a960-4d3d-a372-134d1aebb305" />

- Conduct brute force attack with `mssql_login`

  <img width="1418" height="570" alt="3-3  The Metasploit Framework CTF 1 brute force" src="https://github.com/user-attachments/assets/f20068c5-68c3-4dff-ac47-cd09db0e0f67" />

- Use `mssql_exec` module to run commands on the target host

  <img width="1039" height="402" alt="3-3  The Metasploit Framework CTF 1 whoami" src="https://github.com/user-attachments/assets/724ec0a1-4cdd-4275-9352-cb025fca3342" />
  <img width="1043" height="739" alt="3-3  The Metasploit Framework CTF 1 systeminfo" src="https://github.com/user-attachments/assets/7f7fbdef-1673-41c9-b64a-910585e46162" />

- Upload a payload manually

  <img width="1320" height="342" alt="3-3  The Metasploit Framework CTF 1 payload" src="https://github.com/user-attachments/assets/89bd97bc-998d-418a-a291-3a8fef407057" />
  <img width="1251" height="274" alt="3-3  The Metasploit Framework CTF 1 handler" src="https://github.com/user-attachments/assets/87c1304e-e27f-4387-8d61-601d515b36fe" />
  <img width="1493" height="501" alt="3-3  The Metasploit Framework CTF 1 download" src="https://github.com/user-attachments/assets/ec438a60-8285-4ca8-be34-23a623accec0" />
  <img width="1493" height="361" alt="3-3  The Metasploit Framework CTF 1 run" src="https://github.com/user-attachments/assets/6b8cbde9-90a4-4270-9e6f-c5ac27cad612" />

- Obtained a Meterpreter shell

  <img width="1249" height="184" alt="3-3  The Metasploit Framework CTF 1 Meterpreter" src="https://github.com/user-attachments/assets/349e0ff3-b3e6-43b0-a814-e031ac924a4c" />

- Escalate permission with `getsystem` command

  <img width="996" height="111" alt="3-3  The Metasploit Framework CTF 1 getsystem" src="https://github.com/user-attachments/assets/4c422055-355a-4414-9f8b-88ccdd05f261" />

- Get a shell and obtain the flag 1

  <img width="932" height="714" alt="3-3  The Metasploit Framework CTF 1 flag 1" src="https://github.com/user-attachments/assets/8251b777-008a-41cf-802b-3449e4a15853" />

- Obtain the flag 2

  <img width="858" height="711" alt="3-3  The Metasploit Framework CTF 1 flag 2" src="https://github.com/user-attachments/assets/e0c8a19f-902b-4b31-bfc8-53011b2b5510" />

- Obtained the flag 4

  <img width="640" height="405" alt="3-3  The Metasploit Framework CTF 1 flag 4" src="https://github.com/user-attachments/assets/e09bdb84-387a-45ad-bee8-8a9819782ff0" />

- Obtain the last flag

  <img width="908" height="120" alt="3-3  The Metasploit Framework CTF 1 flag 3" src="https://github.com/user-attachments/assets/a0aa5b61-5715-4351-8e1f-68f3b7e2e7f3" />

# Key Finds

- FLAG 1: c09912a92b8041e982b29457927fa802
- FLAG 2: 9fdeb5b2104b41a5a2e55e0fdfac7473
- FLAG 3: 91ecfb65aade44909aa7aa86c466e5b7
- FLAG 4: 8a1165db03c246e2b59ca61f92fc9707
