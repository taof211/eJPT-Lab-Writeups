<img width="1284" height="245" alt="1-6  Privilege Escalation Impersonate cmd search" src="https://github.com/user-attachments/assets/dd66defd-25fb-4d5d-bdf2-40a165bea835" />---
tags:
  - lab
  - red_team
  - msfconsole
course: link_to_hub_page
module: Host and Networking Penetration Test
topic: System and Host Based Attacks
date: 2025-10-26
status: completed
---
 # Objective

Escalate the privilege on a Windows machine.

# Walkthrough

- Ran `ifconfig` and `ping -c 1 demo.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines aren't in the same subnet

    <img width="917" height="469" alt="1-6  Privilege Escalation Impersonate ifconfig" src="https://github.com/user-attachments/assets/df2b9235-6a05-41f4-9ed2-4db986b2142a" />
    <img width="932" height="238" alt="1-6  Privilege Escalation Impersonate ping" src="https://github.com/user-attachments/assets/95d5dcfe-9c37-47ec-bcb7-82c58e042778" />

- Conduct a nmap scan, `nmap -A -p- -T4 demo.ine.local -oX victim.xml

  <img width="1073" height="744" alt="1-6  Privilege Escalation Impersonate nmap" src="https://github.com/user-attachments/assets/a915cd57-7f1c-4f5f-bf57-ef70f6d1afe5" />

- Launch and initially set up msfconsole

  <img width="1135" height="741" alt="1-6  Privilege Escalation Impersonate msft setup 1" src="https://github.com/user-attachments/assets/ddc4edc1-4d77-4e9f-a437-f4ab7b2a0fbd" />
  <img width="1064" height="377" alt="1-6  Privilege Escalation Impersonate msf setup 2" src="https://github.com/user-attachments/assets/f593460e-6cf8-4f42-ae53-75b3d0784f89" />

- Use `exploit/windows/http/rejetto_hfs_exec` module to exploit the HTTP File Service running on port 80.

  <img width="1256" height="570" alt="1-6  Privilege Escalation Impersonate exploit" src="https://github.com/user-attachments/assets/d933bebe-127c-45b9-b44c-5291e44bd648" />

- Load incognito and use it to do privilege escalation via impersonate

  <img width="941" height="52" alt="1-6  Privilege Escalation Impersonate load" src="https://github.com/user-attachments/assets/93b4a541-df8c-4732-a2a3-86d8783efba2" />
  <img width="1089" height="319" alt="1-6  Privilege Escalation Impersonate list token" src="https://github.com/user-attachments/assets/7c593fbc-4835-48bb-bbc4-ef38f165dc42" />
  <img width="966" height="190" alt="1-6  Privilege Escalation Impersonate impersonate 1" src="https://github.com/user-attachments/assets/992a05c2-4c66-47ba-b980-bdce056f0414" />

- Migrate to explorer.exe

  <img width="1415" height="524" alt="1-6  Privilege Escalation Impersonate migrate" src="https://github.com/user-attachments/assets/d5fd08b9-ab55-42f3-9a04-cf3d60393cd2" />
  
- Get cmd shell and search the flag file under C:\

  <img width="1284" height="245" alt="1-6  Privilege Escalation Impersonate cmd search" src="https://github.com/user-attachments/assets/d69ec1c1-6cc1-4ad2-8b3d-d206264a5daa" />

- Obtain the flag

  <img width="796" height="89" alt="1-6  Privilege Escalation Impersonate falg" src="https://github.com/user-attachments/assets/b1c02a26-8ed0-4e53-8b47-f77dfd6ff704" />

# Key Finds

- FLAG x28c832a39730b7d46d6c38f1ea18e12
