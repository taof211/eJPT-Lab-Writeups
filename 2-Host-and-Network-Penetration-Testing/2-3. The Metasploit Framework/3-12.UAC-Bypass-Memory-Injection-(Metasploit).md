---
tags:
  - lab
  - red_team
  - post_exploit
  - msfconsole
module: Host and Networking Penetration Test
topic: The Metasploit Framework
date: 2025-11-05
status: completed
---
# Objective

Gain the highest privilege on the compromised machine and get administrator user NTLM hash.

# Walkthrough

- Ran `ifconfig` and `ping -c 1 demo.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines aren't in the same subnet

    <img width="720" height="384" alt="3-12  UAC Bypass Memory Injection (Metasploit) ifconfig" src="https://github.com/user-attachments/assets/ac135c05-38ea-436a-a580-879e126316ad" />
    <img width="792" height="216" alt="3-12  UAC Bypass Memory Injection (Metasploit) ping" src="https://github.com/user-attachments/assets/4bbe526e-9cab-4d12-879d-0af2efe2e1df" />

- Conduct an nmap scan

  <img width="1183" height="757" alt="3-12  UAC Bypass Memory Injection (Metasploit) nmap" src="https://github.com/user-attachments/assets/4521dae9-d518-4caf-aa93-dadbca2dce89" />

- Launch and set msfconsole

  <img width="1111" height="747" alt="3-12  UAC Bypass Memory Injection (Metasploit) msf setup" src="https://github.com/user-attachments/assets/a53a4461-5ac0-404f-8e29-47db1cf3a8ed" />

- Use `rejetto_hfs_exec` to exploit the vulnerable service on the host. `getsystem` failed

  <img width="1251" height="704" alt="3-12  UAC Bypass Memory Injection (Metasploit) exploit" src="https://github.com/user-attachments/assets/15f02636-9f98-420c-8328-db9c166c72ad" />

- Get a shell and confirmed that we are in the administrator group

  <img width="1110" height="650" alt="3-12  UAC Bypass Memory Injection (Metasploit) administrators" src="https://github.com/user-attachments/assets/4fcd0ab6-3621-4326-baae-d98b6041da9d" />

- Use `bypassuac_injection` module to bypass UAC

  <img width="1033" height="487" alt="3-12  UAC Bypass Memory Injection (Metasploit) injection" src="https://github.com/user-attachments/assets/a364b9b5-788a-4c03-8548-4ae2bb447dc5" />

- Obtained SYSTEM privilege in the new session

  <img width="822" height="350" alt="3-12  UAC Bypass Memory Injection (Metasploit) SYSTEM" src="https://github.com/user-attachments/assets/de86181e-5388-48c7-adc7-b86ba5c13eac" />

- Migrate to `lsass.exe` to dump the hashes
- 
  <img width="923" height="206" alt="3-12  UAC Bypass Memory Injection (Metasploit) hashes" src="https://github.com/user-attachments/assets/6f791a73-b03a-46ba-af09-c0916e41ac6f" />


# Key Finds

- NTLM Hash: f168d9f8e6c5b893b8c4dfa202228235
