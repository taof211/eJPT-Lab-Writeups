---
tags:
  - lab
  - red_team
  - linux
  - cron_job
module: Host and Networking Penetration Test
topic: System and Host Based Attacks
date: 2025-10-31
status: completed
---
# Objective

Your mission is to get a root shell on the box and retrieve the flag!

# Walkthrough

- In the target linux host, we find there's a file named `message` under our current directory, and we also find the other with the same name under `temp` directory

  <img width="931" height="612" alt="1-12  Cron Job Gone Wild II message" src="https://github.com/user-attachments/assets/41d22ccf-1433-4364-bd00-cb0121a6de66" />

- We find there's a script, `/usr/local/share/copy.sh`, containing the key work `/tmp/message`

  <img width="756" height="249" alt="1-12  Cron Job Gone Wild II shell script" src="https://github.com/user-attachments/assets/dec1f95b-1549-48a4-abfc-30bd16432849" />

- Here we can see the student account is not privileged account, and also we don't have a password to run sudo commands

  <img width="586" height="145" alt="1-12  Cron Job Gone Wild II sudo" src="https://github.com/user-attachments/assets/1e8ba03c-796f-449d-9ffd-41ebd1ea50fb" />

- Write code to escalate permission into the script file. We here use SUID shell payload to escalate without modifying the `sudoer` file.

  <img width="1354" height="223" alt="1-12  Cron Job Gone Wild II escalate" src="https://github.com/user-attachments/assets/66b9f665-85b6-4059-8c0b-4c6ebe064102" />

- Get the flag

  <img width="473" height="122" alt="1-12  Cron Job Gone Wild II flag" src="https://github.com/user-attachments/assets/6988f17e-9363-4a9c-a703-870676dbd12f" />

# Key Finds

- FLAG 697914df7a07bb9b718c8ed258150164
