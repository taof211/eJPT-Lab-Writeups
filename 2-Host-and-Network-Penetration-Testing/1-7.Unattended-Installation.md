---
tags:
  - lab
  - red_team
module: Host and Networking Penetration Test
topic: System and Host Based Attacks
date: 2025-10-27
status: completed
---
# Objective

Gain access to meterpreter session with high privilege.

# Walkthrough

- In the victim machine, we found the Privesc folder

  <img width="603" height="379" alt="1-7  Unattended Installation Privesc" src="https://github.com/user-attachments/assets/ad894029-e29a-49eb-8dcd-1e3495c0c9ce" />

- To import the module and run commands successfully, we need to firstly copy the `Privesc` folder to `C:\Users\students\Documents\WindowsPowerShell\Modules`, the bypass PowerShell Execution Policy

  <img width="770" height="267" alt="1-7  Unattended Installation bypass" src="https://github.com/user-attachments/assets/e20474b6-0f34-4dfd-a1c7-7b017e9d2872" />

- Then we need to launch `PowerUp.ps1` script, import the `Privesc` module, and run command, `Invoke-PrivescAuidt`

  <img width="803" height="244" alt="1-7  Unattended Installation audit" src="https://github.com/user-attachments/assets/3dbfca2f-6752-45be-9d2e-23df6448bba0" />

- From the results, we can see there's an `Unattend.xml` file. Read the file with `notepad`, then we can see the credential information of administrator.

  <img width="1188" height="616" alt="1-7  Unattended Installation credential" src="https://github.com/user-attachments/assets/224ac31f-a600-4eea-b700-ab2a67356774" />

- As we noticed the value of PlainText is false, with means the password could be bas64 encoded. Decoded it.

  <img width="1218" height="87" alt="1-7  Unattended Installation decode" src="https://github.com/user-attachments/assets/78d27559-0e09-4415-b9c6-81b933bce308" />

- Back to Kali machine and conduct a port and service scan

  <img width="753" height="304" alt="1-7  Unattended Installation nmap" src="https://github.com/user-attachments/assets/967debca-1fe9-4503-8305-b73890a0bf7f" />

- Launch and set up msfconsole

  <img width="711" height="547" alt="1-7  Unattended Installation msfconsole setup" src="https://github.com/user-attachments/assets/1c3e5352-8896-47c7-b8d1-e77349a54910" />

- As we found port 445 and 3389 are open, we can potentially access the server with the administrator credential we got through them

  <img width="1106" height="566" alt="1-7  Unattended Installation session creation" src="https://github.com/user-attachments/assets/cbee8985-64a2-457d-9e77-ee8c849a4708" />

- Now we can access the victim in an OS level with the session we created

  <img width="1037" height="309" alt="1-7  Unattended Installation os access-1" src="https://github.com/user-attachments/assets/92382ba1-c27b-4b3a-b47b-596321475ae7" />

- Get a cmd shell and we can find the flag.txt file and its content

  <img width="433" height="90" alt="1-7  Unattended Installation file search" src="https://github.com/user-attachments/assets/da803526-6a99-4bf5-befa-878aa9907e03" />

- FLAG

  <img width="500" height="88" alt="1-7  Unattended Installation flag" src="https://github.com/user-attachments/assets/5212b64c-ad59-45bb-89da-b9e5f33ff4bd" />

# Key Finds

- FLAG 097ab83639dce0ab3429cb0349493f60
