---
tags:
  - lab
  - red_team
module: Host and Networking Penetration Test
topic: System and Host Based Attacks
date: 2025-10-26
status: completed
---
# Objective

Gain the highest privilege on the compromised machine and get admin user NTLM hash.

# Walkthrough

- Ran `ifconfig` and `ping -c 1 demo.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines aren't in the same subnet

    <img width="895" height="453" alt="1 5 - UBA Bypass UBAMe ifconfig" src="https://github.com/user-attachments/assets/519b126d-ed81-497d-a217-9f806b48dca6" />
    <img width="925" height="225" alt="1 5 - UBA Bypass UBAMe ping" src="https://github.com/user-attachments/assets/bdd79c7d-b50f-4fae-937c-405c8023befa" />

- Conduct a nmap scan, `nmap -A -p- -T4 demo.ine.local -oX victim.xml`

  <img width="1137" height="716" alt="1 5 - UBA Bypass UBAMe nmap" src="https://github.com/user-attachments/assets/9f014613-922a-4f7f-96da-912fba35453a" />

- Launch and initially set up msfconsole

  <img width="1298" height="707" alt="1 5 - UBA Bypass UBAMe msfconsole setup" src="https://github.com/user-attachments/assets/7f010716-03c6-41dd-9756-6e3ce4e478cc" />

- Use `exploit/windows/http/rejetto_hfs_exec` module to exploit the HTTP File Service running on port 80.

  <img width="1264" height="405" alt="1 5 - UBA Bypass UBAMe exploit" src="https://github.com/user-attachments/assets/b2fa1540-ea9d-4f43-af74-ce63ac28e9ef" />

- Migrate to explorer.exe and get admin permission

  <img width="1477" height="395" alt="1 5 - UBA Bypass UBAMe migrate" src="https://github.com/user-attachments/assets/1f8f2756-6114-4dad-a3ea-0f9735b1cd76" />

- Failed to escalate permission with `getsystem` command

  <img width="1009" height="241" alt="1 5 - UBA Bypass UBAMe failed ep" src="https://github.com/user-attachments/assets/749b8ee4-f632-463c-9269-a09e31467bd9" />

- Get cmd shell and confirmed the account admin is in the local group "administrators"

  <img width="662" height="139" alt="1 5 - UBA Bypass UBAMe cmd shell" src="https://github.com/user-attachments/assets/0315f10c-3066-44e6-b7c8-f829efd2ee98" />
  <img width="1116" height="296" alt="1 5 - UBA Bypass UBAMe local group" src="https://github.com/user-attachments/assets/5838d8e9-ba10-4530-afe0-e586330acc5e" />

- Create an executive containing reverse tcp payload with msfvenom

  <img width="1313" height="326" alt="1 5 - UBA Bypass UBAMe msfvenom" src="https://github.com/user-attachments/assets/0b68cba7-7d6e-4fb7-a6c0-d69fc97611fd" />

- Upload the executable and UACMe to the temporary folder of the admin user

  <img width="1355" height="449" alt="1 5 - UBA Bypass UBAMe upload" src="https://github.com/user-attachments/assets/68a6bd30-a87e-401c-b68b-48170d41cc85" />

- Use `exploit/multi/handler` module to listen to the session that will be created by the executable created and uploaded.

  <img width="1016" height="249" alt="1 5 - UBA Bypass UBAMe handler" src="https://github.com/user-attachments/assets/7f3e507c-b8e5-4160-b624-3647599f2310" />

- Use UACMe to launch the executable

  <img width="1224" height="115" alt="1 5 - UBA Bypass UBAMe backdoor launch" src="https://github.com/user-attachments/assets/48773edc-7c44-4abf-86cd-840f510d405a" />

- Now a new session established and we can obtain SYSTEM privilege there

  <img width="1377" height="358" alt="1 5 - UBA Bypass UBAMe privilege escalated" src="https://github.com/user-attachments/assets/306ebf1e-eb76-4838-8bf8-952fcfd3ba7f" />

- Now we can migrate lsass.exe to dump hash

  <img width="786" height="94" alt="1 5 - UBA Bypass UBAMe lsass exe" src="https://github.com/user-attachments/assets/9e6f8f5a-6877-4cb9-ba00-caadea28be83" />
  <img width="1295" height="154" alt="1 5 - UBA Bypass UBAMe hashdump" src="https://github.com/user-attachments/assets/a72da060-41cc-446d-8a87-86d51fafd571" />

# Key Finds

FLAG 4d6583ed4cef81c2f2ac3c88fc5f3da6
