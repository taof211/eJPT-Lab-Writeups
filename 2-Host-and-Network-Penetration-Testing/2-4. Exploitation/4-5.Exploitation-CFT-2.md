---
tags:
  - lab
  - ctf
  - red_team
  - msfconsole
course: "[[_Hub - Penetration Testing Student]]"
module: Host and Networking Penetration Test
topic: Exploitation
date: 2025-11-10
status: completed
---
# Objective

A target machine is accessible at **target.ine.local**. Identify the services and capure the flags.

- **Flag 1:** Looks like smb user **tom** has not changed his password from a very long time.
- **Flag 2:** Using the NTLM hash list discovered in the previous challenge, can you compromise the smb user **nancy**?
- **Flag 3:** I wonder what the hint found in the previous challenge be useful for!
- **Flag 4:** Can you compromise the target machine and retrieve the **C://flag4.txt** file?

The following wordlist will be useful:

- /usr/share/wordlists/metasploit/unix_passwords.txt

# Walkthrough

- Ran `ifconfig` and `ping -c 1 target.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines are not in the same subnet

    <img width="818" height="380" alt="4-5  Exploitation CFT 2 ifconfig" src="https://github.com/user-attachments/assets/c246cca8-bd54-40ad-87d4-3e9769019eee" />
    <img width="842" height="193" alt="4-5  Exploitation CFT 2 ping" src="https://github.com/user-attachments/assets/248b7642-8bde-4734-9046-bf93ce87e44d" />

- Conduct an nmap scan

  <img width="957" height="739" alt="4-5  Exploitation CFT 2 nmap 1" src="https://github.com/user-attachments/assets/9dcf86ba-af0f-416c-aabf-afef548fe314" />
  <img width="1054" height="750" alt="4-5  Exploitation CFT 2 nmap 2" src="https://github.com/user-attachments/assets/e2a8193a-193f-4a5f-b34d-974e7f28d9a1" />

- Use `smb_login` to conduct brute force attack against the user tom

  <img width="1267" height="604" alt="4-5  Exploitation CFT 2 brute force" src="https://github.com/user-attachments/assets/720bc600-2118-4dab-8506-188e08a71eca" />

- Try accessing shares

  <img width="1501" height="528" alt="4-5  Exploitation CFT 2 shares" src="https://github.com/user-attachments/assets/fe5ff000-9d81-4b81-9ed0-2ea4d37de5fd" />

- Get the flag 1

  <img width="1480" height="340" alt="4-5  Exploitation CFT 2 flag 1" src="https://github.com/user-attachments/assets/fc54098e-30c5-408d-b1a4-64793d6e000f" />

- Save the leaked hashes into a local file

  <img width="1064" height="645" alt="4-5  Exploitation CFT 2 hashes" src="https://github.com/user-attachments/assets/9d687033-fcd9-46fb-b2bd-ef2f9d3ae4b8" />

- Obtained nancy's NTML hash

  <img width="1362" height="367" alt="4-5  Exploitation CFT 2 nancy" src="https://github.com/user-attachments/assets/d32295fd-d8e3-49d4-b8c4-dd6c1eeab72f" />

- Get the flag 2 and hint

  <img width="574" height="289" alt="4-5  Exploitation CFT 2 shares 1" src="https://github.com/user-attachments/assets/4b1eb06f-6384-454d-a3f0-2739d4851409" />
  <img width="782" height="172" alt="4-5  Exploitation CFT 2 flag 2" src="https://github.com/user-attachments/assets/0e72e9cf-bf9d-4bfc-9e00-641841c4835f" />

- Use david's credential to access ftp service on the host

  <img width="1498" height="549" alt="4-5  Exploitation CFT 2 ftp" src="https://github.com/user-attachments/assets/07f442f8-666c-48f2-9ac6-8ce6ad5b361f" />

- Get the flag 3

  <img width="430" height="88" alt="4-5  Exploitation CFT 2 flag 3" src="https://github.com/user-attachments/assets/274a29a3-1e61-4444-8587-a15b0d5a7b19" />

- It seems that we are allowed to upload files into the ftp service

  <img width="1481" height="207" alt="4-5  Exploitation CFT 2 upload" src="https://github.com/user-attachments/assets/ea5a7af8-c24c-4df4-9305-4f5a893416da" />

- Create a webshell and upload it to the ftp service

  <img width="1500" height="110" alt="4-5  Exploitation CFT 2 webshell" src="https://github.com/user-attachments/assets/80f5bc84-f192-4be0-b498-c19a194e6cde" />
  <img width="1474" height="604" alt="4-5  Exploitation CFT 2 upload-1" src="https://github.com/user-attachments/assets/b91d50a7-482e-4d8a-92db-f867c2394077" />

- Set up a handler

  <img width="1076" height="189" alt="4-5  Exploitation CFT 2 handler" src="https://github.com/user-attachments/assets/a2a87958-5216-4e35-bfc5-0bbf1cc45229" />

- Try executing the webshell

  <img width="906" height="262" alt="4-5  Exploitation CFT 2 executing" src="https://github.com/user-attachments/assets/21c0c3dc-43c6-46e0-a91c-b3efa305351e" />

- Get a shell and the flag 4

  <img width="1356" height="319" alt="4-5  Exploitation CFT 2 meterpreter" src="https://github.com/user-attachments/assets/7bcdcf7a-095d-470e-9876-300a0c193711" />
  <img width="818" height="221" alt="4-5  Exploitation CFT 2 flag 4" src="https://github.com/user-attachments/assets/a1269c8e-0d49-4f5a-bb8c-3505daa9750f" />

# Key Finds

- FLAG 1 28cbce6acdc24692904f6b47650ea404
- FLAG 2 5cacfdf3542b470a9b4be8bc3ce63f24
- FLAG 3 d04b269330634f0e83be1751a8f8b55f
- FLAG 4 84216bb98a2d4001a2af91758e3300ee
