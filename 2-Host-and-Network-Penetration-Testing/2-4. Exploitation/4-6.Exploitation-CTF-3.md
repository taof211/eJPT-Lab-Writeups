---
tags:
  - lab
  - ctf
  - red_team
  - msfconsole
module: Host and Networking Penetration Test
topic: Exploitation
date: 2025-11-11
status: completed
---
# Objective

Two machines are accessible at **target1.ine.local** and **target2.ine.local**. Enumerate the targets, identify and exploit the misconfigurations or vulnerabilities to capture the flags. The flag is in an md5 hash format.

- **Flag 1:** A vulnerable service maybe running on **target1.ine.local**. If exploitable, retrieve the flag from the root directory.
- **Flag 2:** Further, a quick interaction with a local network service on **target1.ine.local** may reveal this flag. Use the hint given in the previous flag.
- **Flag 3:** A misconfigured service running on **target2.ine.local** may help you gain access to the machine. Can you retrieve the flag from the root directory? 
- **Flag 4:** Can you escalate to root on **target2.ine.local** and read the flag from the restricted /root directory?

# Walkthrough

- Ran `ifconfig` and `ping -c 1 target1.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines are in the same subnet

    <img width="822" height="395" alt="4-6  Exploitation CTF 3 ifconfig" src="https://github.com/user-attachments/assets/5a4fb6b5-2791-461f-a373-f1d9a1bb4ba0" />
    <img width="830" height="209" alt="4-6  Exploitation CTF 3 ping 1" src="https://github.com/user-attachments/assets/f62271e4-926d-4c43-ab80-aa55f884a770" />

- Conduct an nmap

  <img width="1040" height="484" alt="4-6  Exploitation CTF 3 nmap 1" src="https://github.com/user-attachments/assets/a22f354f-f29d-4550-89fc-6032e493e90a" />

- Do exploit search 

  <img width="1511" height="411" alt="4-6  Exploitation CTF 3 exploit search 1" src="https://github.com/user-attachments/assets/eb11ba20-d234-4071-9dd8-492a4366336c" />

- Find the website directory

  <img width="840" height="290" alt="4-6  Exploitation CTF 3 directory" src="https://github.com/user-attachments/assets/0af95ea6-94ef-4204-86b2-65fc2e8ce8ed" />

- Use `proftpd_modcopy_exec` module to exploit the vulnerable service on target 1

  <img width="1225" height="485" alt="4-6  Exploitation CTF 3 exploit" src="https://github.com/user-attachments/assets/11af87c1-2ae6-4abf-a21f-1e90630b17dc" />

- Upgrade the session 

  <img width="1223" height="415" alt="4-6  Exploitation CTF 3 upgrade" src="https://github.com/user-attachments/assets/230cbe1f-0ca8-498c-8b48-420afaa68d8e" />

- Get the flag 1

  <img width="847" height="299" alt="4-6  Exploitation CTF 3 flag 1" src="https://github.com/user-attachments/assets/b5a581b0-7d09-4409-9fab-22c04d7df500" />

- Check the open ports on the host

  <img width="1015" height="351" alt="4-6  Exploitation CTF 3 netstat" src="https://github.com/user-attachments/assets/a5ca4f29-ab62-4dc1-9e9c-38c782e75167" />

- Get the flag 2

  <img width="832" height="284" alt="4-6  Exploitation CTF 3 flag 2" src="https://github.com/user-attachments/assets/0206c934-970c-43bc-8cd4-c11aee3f8ea5" />

- ping target 2 and found it's reachable and in the same subnet with the previous machines

  <img width="832" height="198" alt="4-6  Exploitation CTF 3 ping 2" src="https://github.com/user-attachments/assets/4af711d7-e434-4ed7-935a-18367d39aad1" />

- Conduct an nmap scan against the target 2

  <img width="1062" height="688" alt="4-6  Exploitation CTF 3 nmap 2" src="https://github.com/user-attachments/assets/ba9de156-f106-43a0-9605-f21a7f95569e" />

- Search exploit

  <img width="1490" height="540" alt="4-6  Exploitation CTF 3 exploit search 2" src="https://github.com/user-attachments/assets/b74e490f-a17f-4e46-bce2-31c8694fd5df" />

- Use `gobuster` to enumerate the directories of the web service

  <img width="850" height="528" alt="4-6  Exploitation CTF 3 http enum" src="https://github.com/user-attachments/assets/f771ae1f-b43b-4c38-b28e-81d1a5576fcc" />

- Didn't find entry point with http service. Switch to smb. Use `smb_login` module to conduct a brute force attack

  <img width="1232" height="432" alt="4-6  Exploitation CTF 3 brute force" src="https://github.com/user-attachments/assets/77a96ede-0817-4404-807f-8156cf363303" />

- Session is created and shares are listed

  <img width="1376" height="573" alt="4-6  Exploitation CTF 3 shares" src="https://github.com/user-attachments/assets/68e76127-cb8a-4aea-90df-dbca2be25e2a" />

- Use `smb/upload_file` to test if we can upload files into `site-uploads` share

  <img width="964" height="342" alt="4-6  Exploitation CTF 3 upload test" src="https://github.com/user-attachments/assets/55619e1e-f3cc-47fa-ab78-ffd08a195ba2" />

- Upload succeed

  <img width="796" height="235" alt="4-6  Exploitation CTF 3 upload successful" src="https://github.com/user-attachments/assets/c39fa6a1-80a3-4384-a7e8-1905b8cba2aa" />

- Copy and modify the php reverse webshell

  <img width="913" height="330" alt="4-6  Exploitation CTF 3 webshell mod" src="https://github.com/user-attachments/assets/0bd9ba8b-1dfe-4b8c-96e5-dec872ea343e" />

- Upload the shell

  <img width="949" height="288" alt="4-6  Exploitation CTF 3 upload shell" src="https://github.com/user-attachments/assets/0a2df8e9-8364-4439-a56d-45184f35958b" />

- Set up a handler

  <img width="737" height="229" alt="4-6  Exploitation CTF 3 handler" src="https://github.com/user-attachments/assets/13f88697-fdd0-4f1a-95c7-072b395333da" />

- Execute the webshell and get access to the target 2

  <img width="1505" height="308" alt="4-6  Exploitation CTF 3 access 2" src="https://github.com/user-attachments/assets/2fe9141a-e2e5-4892-ac0b-26af603487bf" />

- Upgrade the shell

  <img width="1512" height="665" alt="4-6  Exploitation CTF 3 upgrade 2" src="https://github.com/user-attachments/assets/a5de1714-e4b5-4bee-b917-bc9f30d2669b" />

- Get the flag 3

  <img width="1123" height="497" alt="4-6  Exploitation CTF 3 flag 3" src="https://github.com/user-attachments/assets/f9d317a2-03c1-4f71-804e-4202efa730bc" />

- Look for SUID

  <img width="851" height="323" alt="4-6  Exploitation CTF 3 SUID" src="https://github.com/user-attachments/assets/8a23158c-4e93-499f-9c6d-9291b4080955" />

- Escalate permission to root with abuse `find`

  <img width="1006" height="196" alt="4-6  Exploitation CTF 3 root" src="https://github.com/user-attachments/assets/a945bc78-3d2e-444e-b932-a26242ca2123" />

- Get the flag 4

  <img width="613" height="213" alt="4-6  Exploitation CTF 3 flag 4" src="https://github.com/user-attachments/assets/c583043d-a045-4396-836a-b5acb475720d" />

# Key Finds

- FLAG 1: 15627a4ce82440b8a4a9a46b4fb6b46e
- FLAG 2: 2f0c2d45a66c417da6ca91dd15c354bc
- FLAG 3: 5e12a3971fe64a01934eca5be9dd907c
- FLAG 4: 29c1e29557e94739903823ca6ccf5cb6
