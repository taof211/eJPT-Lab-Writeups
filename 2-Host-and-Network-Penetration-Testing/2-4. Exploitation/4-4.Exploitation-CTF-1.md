---
tags:
  - lab
  - ctf
  - red_team
  - msfconsole
module: Host and Networking Penetration Test
topic: Exploitation
date: 2025-11-10
status: completed
---
# Objective

Two Linux machines are accessible at **target1.ine.local** and **target2.ine.local**. Identify the application and service running on these machines, and capture the flags. The flag is an md5 hash format.

- **Flag 1:** Identify and exploit the vulnerable web application running on **target1.ine.local** and retrieve the flag from the root directory. The credentials **admin:password1** may be useful.
- **Flag 2:** Further, identify and compromise an insecure system user on **target1.ine.local**.
- **Flag 3:** Identify and exploit the vulnerable plugin used by the web application running on **target2.ine.local** and retrieve the **flag3.txt** file from the root directory.
- **Flag 4:** Further, identify and compromise a system user requiring no authentication on **target2.ine.local**.

# Walkthrough

- Ran `ifconfig` and `ping -c 1 target1.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines are in the same subnet

    <img width="758" height="388" alt="4-4  Exploitation CTF 1 ifconfig" src="https://github.com/user-attachments/assets/3d64c594-f389-470b-8f24-9f9184866750" />
    <img width="931" height="208" alt="4-4  Exploitation CTF 1 ping" src="https://github.com/user-attachments/assets/9cb8bb70-23a4-4d6c-831e-ed6517a71240" />

- Conduct an nmap scan

  <img width="882" height="650" alt="4-4  Exploitation CTF 1 nmap" src="https://github.com/user-attachments/assets/d23a7a1f-950a-4770-b7c5-8369fda62027" />

- Login into the website with provided credential and found the version of flatCore

  <img width="905" height="249" alt="4-4  Exploitation CTF 1 version" src="https://github.com/user-attachments/assets/a43379f8-8407-4ed2-9fef-63f793961cd4" />

- Find the vulnerability of the service: [RCE via upload addons plugin · Issue #52 · flatCore/flatCore-CMS](https://github.com/flatCore/flatCore-CMS/issues/52)
- Set and run a handler in msfconsole

  <img width="909" height="578" alt="4-4  Exploitation CTF 1 handler" src="https://github.com/user-attachments/assets/f50afd67-1a3c-4231-aec1-bb495de6eb63" />

- Change variables in php reverse web shell

  <img width="791" height="218" alt="4-4  Exploitation CTF 1 webshell" src="https://github.com/user-attachments/assets/7cde7f33-db60-41d1-9bdc-7808ba19309a" />

- Upload the webshell

  <img width="1200" height="687" alt="4-4  Exploitation CTF 1 upload" src="https://github.com/user-attachments/assets/9ea02f56-fd75-4f12-a669-69ed78bc39bd" />

- Run the webshell and we get a shell in msfconsole handler

  <img width="841" height="429" alt="4-4  Exploitation CTF 1 exploit" src="https://github.com/user-attachments/assets/83905535-b161-4fef-8324-605363d999c6" />
  <img width="1366" height="320" alt="4-4  Exploitation CTF 1 shell" src="https://github.com/user-attachments/assets/677473a9-bee8-4e8a-b30c-2cb7a8693d8e" />

- Get the flag 1

  <img width="787" height="617" alt="4-4  Exploitation CTF 1 flag 1" src="https://github.com/user-attachments/assets/4f197c25-5363-4034-933e-321e0fc8d2b7" />

- List all users in the host

  <img width="929" height="582" alt="4-4  Exploitation CTF 1 users" src="https://github.com/user-attachments/assets/37db4be8-6634-4eae-979a-531b6005bbf4" />

- Upgrade session

  <img width="1490" height="440" alt="4-4  Exploitation CTF 1 upgrade" src="https://github.com/user-attachments/assets/b0753a07-f23b-4e8d-adba-6186c629d27f" />

- Conduct a brute force attack against the weak user and gain their password

  <img width="1487" height="348" alt="4-4  Exploitation CTF 1 brute force" src="https://github.com/user-attachments/assets/bf8cb64c-170b-4113-8dd8-a019552f6e0c" />

- Established a new session via port 22

  <img width="1469" height="636" alt="4-4  Exploitation CTF 1 new session" src="https://github.com/user-attachments/assets/88472d69-fbdd-421d-a8cf-d5f6b98d8c56" />

- Get the flag 2

  <img width="869" height="365" alt="4-4  Exploitation CTF 1 flag 2" src="https://github.com/user-attachments/assets/ee5e123d-8653-4fb9-aa66-ff2d20cd2401" />

- Ping target 2 and found it's reachable and in the same subnet.

  <img width="850" height="199" alt="4-4  Exploitation CTF 1 ping 2" src="https://github.com/user-attachments/assets/5d40528e-b6df-4c02-a272-d9c84c144efe" />

- Conduct an nmap scan against it

  <img width="1018" height="584" alt="4-4  Exploitation CTF 1 nmap-1" src="https://github.com/user-attachments/assets/67a8a28e-6a63-41da-9a27-8af0dcb55492" />

- Use `wpscan` and find two interesting plugins in the website 2

  <img width="1418" height="687" alt="4-4  Exploitation CTF 1 wpscan" src="https://github.com/user-attachments/assets/d6e4994a-b2f3-4dd3-85b2-77ce489d982a" />
  <img width="967" height="677" alt="4-4  Exploitation CTF 1 plugins" src="https://github.com/user-attachments/assets/3394606b-87af-4f0d-adf2-57093bb0e67d" />

- Find the vulnerable plugin with available exploits1

  <img width="1493" height="649" alt="4-4  Exploitation CTF 1 exploit search" src="https://github.com/user-attachments/assets/46683c42-afbb-4a4c-9ce1-e14d457d1ece" />

- Obtain flag 3 with `wp_duplicator_file_read` module

  <img width="1172" height="308" alt="4-4  Exploitation CTF 1 the flag 3" src="https://github.com/user-attachments/assets/631739e6-81c7-4b29-8620-cb6b46ee6103" />

- Use `wp_duplicator_file_read` module to read `passwd` file on target 2 machine

  <img width="984" height="699" alt="4-4  Exploitation CTF 1 passwd 2" src="https://github.com/user-attachments/assets/8aab985d-4980-45b9-a353-5735edcbdffe" />

- ssh to target 2 with the user and an empty password

  <img width="972" height="640" alt="4-4  Exploitation CTF 1 ssh 2" src="https://github.com/user-attachments/assets/26cdf90e-62ad-447f-90d2-c45fbce2a1aa" />

- Get the flag 4

  <img width="749" height="187" alt="4-4  Exploitation CTF 1 flag 4" src="https://github.com/user-attachments/assets/e7523775-77b3-44fc-82f5-7a9b11563199" />

# Key Finds

- FLAG 1 9d81b07d8bd04c9f92bf0ddfdafc8900
- FLAG 2 81e9db06720e42d5940417b68f8dcf9d
- FLAG 3 de7abaacfb574c6da864eeb5791598ac
- FLAG 4 e32b72c686494b019f13281842766f0c
