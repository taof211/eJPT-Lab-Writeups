---
tags:
  - lab
  - red_team
  - SMB
module: Host and Networking Penetration Test
topic: Network Penetration Testing
date: 2025-11-01
status: completed
---
# Objective

Exploit both the target and find the flag!

# Walkthrough

Ran `ifconfig`, `ping -c 1 target.ine.local` and `ping -c 1 target1.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of all the machines
	- The target 1 machine is online and pingable, but the target 2 is not.
	- The target machines are not in the same subnet as the attack box.

    <img width="820" height="386" alt="2-1  NetBIOS Hacking ifconfig" src="https://github.com/user-attachments/assets/742a34a7-0f1c-4962-8d6a-7b1fdcf8513b" />
    <img width="879" height="368" alt="2-1  NetBIOS Hacking ping 1" src="https://github.com/user-attachments/assets/f2b56938-434c-4281-9bce-554d41a13ee5" />

- Conduct nmap scan on the target 1

  <img width="959" height="446" alt="2-1  NetBIOS Hacking nmap 1" src="https://github.com/user-attachments/assets/76459b29-c389-4f60-9ee5-0addea708084" />
  <img width="962" height="759" alt="2-1  NetBIOS Hacking nmap 2" src="https://github.com/user-attachments/assets/29d1069c-ed39-42eb-bc44-451c61573613" />

- As the nmap script result showing `account_used: guest`, which means it allows guest login. So we can use `smbclient` to list shares in the server.

  <img width="897" height="361" alt="2-1  NetBIOS Hacking shares" src="https://github.com/user-attachments/assets/de990cbb-2677-4c2a-90a8-07794bec0c58" />

- Also we can use `enum4linux` to enumerate users in the server

  <img width="1180" height="698" alt="2-1  NetBIOS Hacking enum4linux 1" src="https://github.com/user-attachments/assets/ffe54fa6-a0f2-4dca-9c93-288c0ad2706a" />
  <img width="1425" height="586" alt="2-1  NetBIOS Hacking enum4linux 2" src="https://github.com/user-attachments/assets/7840de47-d699-45f8-876d-a1987e3a873d" />

- Using the accounts found by `enum4linux`, ran a brute force attack with `hydra`

  <img width="1485" height="554" alt="2-1  NetBIOS Hacking brute force" src="https://github.com/user-attachments/assets/d8240700-914d-4c06-a122-d3f11d427eb5" />

- Launch msfconsole and initially set it up.

  <img width="806" height="444" alt="2-1  NetBIOS Hacking msf setup" src="https://github.com/user-attachments/assets/64c4b0ea-507c-4769-8d16-b67ea4e83371" />

- Use `psexec` module to gain access to target 1 machine

  <img width="1053" height="359" alt="2-1  NetBIOS Hacking exploit 1" src="https://github.com/user-attachments/assets/97ce1ed2-2a33-4dec-8aa1-466ad4d0ba6a" />

- Get a shell and we found the network between target 1 and target 2 is connected, which means we can use target 1 to pivot to target 2.

  <img width="806" height="528" alt="2-1  NetBIOS Hacking connection check" src="https://github.com/user-attachments/assets/59032a53-ea5a-4484-abf3-7515d01e7690" />

- Check the network configuration of target 1

  <img width="700" height="731" alt="2-1  NetBIOS Hacking ipconfig" src="https://github.com/user-attachments/assets/1871cf9f-fcd8-4f89-93cc-a36395bd8709" />

- Add the subnet of target 1 into route of the session

  <img width="810" height="415" alt="2-1  NetBIOS Hacking autoroute" src="https://github.com/user-attachments/assets/9b439a23-c59f-4653-a10b-b23f5c8a7262" />

- Check `/etc/proxychains4.conf`, we can see socks4 127.0.0.1:9050 has been configured.

  <img width="883" height="634" alt="2-1  NetBIOS Hacking proxy chain" src="https://github.com/user-attachments/assets/19f98c7a-1acd-45b6-be3a-027b9241128e" />

- Enable a socks proxy with module `socks_proxy`

  <img width="769" height="206" alt="2-1  NetBIOS Hacking socks proxy" src="https://github.com/user-attachments/assets/d6d644bb-f3f1-4f56-b59d-8d3bffd1fda7" />

- Now we can conduct nmap scan against the target 2

  <img width="1147" height="429" alt="2-1  NetBIOS Hacking nmap 3" src="https://github.com/user-attachments/assets/b4715649-b38d-420f-9d54-48b98c641877" />

- Now we back to the Meterpreter, migrate to explorer.exe and enter the cmd shell of the first target machine

  <img width="740" height="244" alt="2-1  NetBIOS Hacking migrate and shell" src="https://github.com/user-attachments/assets/ef3c170a-cf6a-4b4c-9ba4-010d8d9f9151" />

- Use `net view` command to view shares on the target 2

  <img width="980" height="321" alt="2-1  NetBIOS Hacking net view" src="https://github.com/user-attachments/assets/05a28fd6-7c2e-4f96-8419-f80859e7bdcf" />

- Map the shares to drvies on the target 1

  <img width="1022" height="218" alt="2-1  NetBIOS Hacking map" src="https://github.com/user-attachments/assets/ae1b2961-3213-4ee9-9526-5ddc8291c19b" />

- View files in the shares

  <img width="894" height="649" alt="2-1  NetBIOS Hacking shared files" src="https://github.com/user-attachments/assets/23ca8787-a6ed-4343-9ac8-219009251068" />

- Obtain the flag

  <img width="623" height="140" alt="2-1  NetBIOS Hacking flag" src="https://github.com/user-attachments/assets/7606a856-8d19-4bdf-adfe-74de4e10994c" />

