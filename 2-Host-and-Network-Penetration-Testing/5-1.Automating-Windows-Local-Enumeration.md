<img width="1111" height="496" alt="5-1  Automating Windows Local Enumeration local group manual 1" src="https://github.com/user-attachments/assets/e4318f22-25b5-4db4-9f97-575c39b0c28d" />---
tags:
  - lab
  - red_team
  - msfconsole
module: Host and Networking Penetration Test
topic: Post Exploitation
date: 2025-11-12
status: completed
---
# Objective

To automate local enumeration on Windows by leveraging various post-exploitation Metasploit modules and local enumeration scripts.

# Walkthrough

- Manually enumerate Windows Version Information

  <img width="748" height="124" alt="5-1  Automating Windows Local Enumeration Windows Version Manual" src="https://github.com/user-attachments/assets/64dd3b4a-2b98-43c7-9fc0-54f8ab52732f" />

- Display hotfixes and service packs manually

  <img width="1482" height="625" alt="5-1  Automating Windows Local Enumeration hotfix manual" src="https://github.com/user-attachments/assets/899b4776-5009-4406-8a35-26f2e434af60" />

- Use `enum_patches` module to automatically enumerate hotfixes installed on the host

  <img width="1006" height="664" alt="5-1  Automating Windows Local Enumeration hotfixes auto" src="https://github.com/user-attachments/assets/0f09fab6-9e1b-43e5-9a12-cfabbffae805" />

- Display system architecture manually

  <img width="745" height="193" alt="5-1  Automating Windows Local Enumeration architecture manual" src="https://github.com/user-attachments/assets/b39a6b77-8a4b-43c3-be3d-eb69755982b4" />

- Display drives manually

  <img width="787" height="209" alt="5-1  Automating Windows Local Enumeration drive manual" src="https://github.com/user-attachments/assets/0572d5d5-e452-4dc1-96da-a598ffd5894d" />

- Display environment variables manually

  <img width="1507" height="675" alt="5-1  Automating Windows Local Enumeration environment variable manual" src="https://github.com/user-attachments/assets/40c91c29-ac94-4b6f-8323-4448e1bf85a8" />

- Display shares manually

  <img width="986" height="266" alt="5-1  Automating Windows Local Enumeration share manual" src="https://github.com/user-attachments/assets/7df9bdda-568f-4a0d-83d9-88610fa11840" />
  
- Display services hosted in each process manually

  <img width="1070" height="698" alt="5-1  Automating Windows Local Enumeration service manual" src="https://github.com/user-attachments/assets/8bf55f6d-01dc-4272-8150-9d4c17801e87" />

- Use `enum_applications` to enumerate applications and programs on the host automatically

  <img width="1450" height="467" alt="5-1  Automating Windows Local Enumeration application auto" src="https://github.com/user-attachments/assets/9f80299f-749d-41e9-8399-2044f2e32532" />

- Use 'checkvm' module to check if the host is running within a VM

  <img width="1027" height="163" alt="5-1  Automating Windows Local Enumeration check vm auto" src="https://github.com/user-attachments/assets/805be9c9-f46d-4724-aa4c-dac1152a1318" />

- Enumerate network interface information manually

  <img width="1069" height="685" alt="5-1  Automating Windows Local Enumeration network interface manual" src="https://github.com/user-attachments/assets/e133af30-ab44-4e67-b5e5-755fc2e29793" />

- Display local DNS cache manually

  <img width="940" height="648" alt="5-1  Automating Windows Local Enumeration dns cache manual" src="https://github.com/user-attachments/assets/e665eeec-cab4-4f13-8384-3380738ce1ce" />

- Display all connections and port with associated PIDs

  <img width="1214" height="683" alt="5-1  Automating Windows Local Enumeration connections manual" src="https://github.com/user-attachments/assets/5cb2bd70-0739-426b-a1c3-adf380faaf9a" />

- Display route table manually

  <img width="1006" height="692" alt="5-1  Automating Windows Local Enumeration route table manual" src="https://github.com/user-attachments/assets/532a05ea-273e-4450-86d7-aab0cc20699c" />

- Display ARP table manually

  <img width="822" height="399" alt="5-1  Automating Windows Local Enumeration arp manual" src="https://github.com/user-attachments/assets/1edf3d4c-8042-4a52-9ecf-45752ec07fe7" />

- Display firewall profiles manually

  <img width="1191" height="673" alt="5-1  Automating Windows Local Enumeration firewall manual" src="https://github.com/user-attachments/assets/17888be6-d228-4aa0-acd3-a42fe6e1303f" />

- Display current account's username manually

  <img width="588" height="101" alt="5-1  Automating Windows Local Enumeration username manual" src="https://github.com/user-attachments/assets/1c14bdc2-000a-4979-8c5b-415587b415d8" />

- Check current account's privileges manually

  <img width="1507" height="709" alt="5-1  Automating Windows Local Enumeration privileges manual" src="https://github.com/user-attachments/assets/7111982d-e96e-47f4-ae3a-4ad64596af5b" />

- Use `gather/win_privs` module to automatically enumerate current user's privileges

  <img width="1238" height="699" alt="5-1  Automating Windows Local Enumeration privilege auto" src="https://github.com/user-attachments/assets/921f0470-4466-4ada-be73-9a47aa4069bf" />

- Check local users manually

  <img width="992" height="276" alt="5-1  Automating Windows Local Enumeration users manual" src="https://github.com/user-attachments/assets/88ce872a-9044-4fb5-ad2b-c563b40b6483" />

- Use `enum_logged_on_users` module to enumerate current and previous logged on users

  <img width="1229" height="688" alt="5-1  Automating Windows Local Enumeration logged on user auto" src="https://github.com/user-attachments/assets/1896c543-7f9d-442e-b7d2-f529dbce2333" />

- Check local groups manually

  <img width="1111" height="496" alt="5-1  Automating Windows Local Enumeration local group manual 1" src="https://github.com/user-attachments/assets/f0ed68a8-079d-4075-a45c-cb96a877fbbd" />
  <img width="1111" height="268" alt="5-1  Automating Windows Local Enumeration local group manual 2" src="https://github.com/user-attachments/assets/0a780773-5ece-47cc-b7f8-56728c9f6ac3" />

- Check scheduled tasks manually (`schtasks /query /fo list`)

  <img width="1025" height="618" alt="5-1  Automating Windows Local Enumeration schedule tasks manual" src="https://github.com/user-attachments/assets/30b92747-7ea1-4a92-a433-be6a4707a4f7" />

- Use JAWS Enumeration script to do enumeration automatically

  <img width="1391" height="245" alt="5-1  Automating Windows Local Enumeration JAWS auto" src="https://github.com/user-attachments/assets/7e6bd1e0-3c01-47d1-b99e-3371483a77ae" />
