---
tags:
  - lab
  - red_team
  - T1190
  - T1059_003
  - T1505_003
  - WebDAV
  - IIS
  - nmap
  - web
module: Assessment Methodologies
topic: Vulnerability Assessment
date: 2025-10-19
status: completed
---
# Objective

Exploit the WebDAV service and retrieve the flag!

**The following username and password may be used to access the service:**

| Username | Password | | bob | password_123321 |

# Walkthrough

- Ran `ifconfig` and `ping -c 1 demo.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines aren't in the same subnet

    <img width="902" height="457" alt="4-1  Windows IIS Server DavTest ifconfig" src="https://github.com/user-attachments/assets/c72caf53-1db1-486e-97fd-4f68f595b141" />
    <img width="923" height="229" alt="4-1  Windows IIS Server DavTest ping" src="https://github.com/user-attachments/assets/d7367cb5-bfd6-49dc-82fb-1c27b0705ed7" />

- Because our target today is WebDAV, we do a port and service scanning on port 80 and 443 first, `nmap -sS -sV -p 80,443 -sC 10.2.21.1 -T4`

  <img width="1450" height="625" alt="4-1  Windows IIS Server DavTest nmap" src="https://github.com/user-attachments/assets/f65d698a-1a63-4a27-83b4-0a82fee3d567" />

- Now we know there's a WebDAV service running on port 80 but cannot get more details. So we now use `http-enum` script to see if we can enumerate more details about the service, `nmap -sS -sV -p 80 --script=http-enum 10.2.21.1 -T4`

  
- The script above provide me the exact directory of WebDAV on the site as well as the fact there's an authentication request. I don't want to use `DavTest`, which would create lots of noises in a real attack. We gonna use `curl` command instead, to conduct a series of manual check.
	- `curl -i -X OPTIONS http://demo.ine.local/webdav/ -u bob:password_123321` - Test allowed options in the page

	  <img width="1346" height="303" alt="4-1  Windows IIS Server DavTest options" src="https://github.com/user-attachments/assets/fc827585-df63-40e1-bb39-70e074580cbc" />

	- `curl -i -T test.txt http://demo.ine.local/webdav/test.txt -u bob:password_123321` - Test if it allows update a txt file into the directory
	- `curl -i http://demo.ine.local/webdav/test.txt -u bob:password_123321` - Test if previous uploading was successful

	  <img width="1311" height="665" alt="4-1  Windows IIS Server DavTest upload verify" src="https://github.com/user-attachments/assets/b72ce883-aa15-421e-abde-e4058523871e" />

	- It was successful. As an attacker, don't forget to clean your trace, `curl -i -X DELETE http://demo.ine.local/webdav/test.txt -u bob:password_123321`
- Though our previous steps didn't test all extensions uploading as the official solution, it creates less noises than using `DavTest`. We could repeat the process to test more extensions uploading manually.
- Now we are going to upload webshell into the directory with `cadaver`. 

  <img width="917" height="250" alt="4-1  Windows IIS Server DavTest cadaver webshell" src="https://github.com/user-attachments/assets/3161b8e4-5854-4d4b-aab3-47fce2f1b0bb" />

- Similarly, we can also use `curl` commands to upload the webshell.

  <img width="1291" height="216" alt="4-1  Windows IIS Server DavTest curl webshell 1" src="https://github.com/user-attachments/assets/d169b191-5fbc-4186-bec0-e1be41005d46" />

- Switch to web browser, open the webshell and browse the file system of the server. And then we can get the flag

  <img width="873" height="383" alt="4-1  Windows IIS Server DavTest flag" src="https://github.com/user-attachments/assets/f25a95cf-5e49-4ed7-8744-95ed1e7cbbc5" />

# Key Finds

- Flag: 0cc175b9c0f1b6a831c399e269772661

# Tools Used

- NMAP - [[NMAP MOC]]
- NMAP NSE [[http-enum]] Script
- ``curl``
- `cavader`
# Lesson Learnt

- Never trust OPTIONS response, it's only a reference but not the final answer. Testing it with `curl -T` is the best way to verify file uploading
