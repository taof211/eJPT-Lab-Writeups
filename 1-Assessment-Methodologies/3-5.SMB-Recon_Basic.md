---
tags:
  - "lab"
  - enumeration
  - T1046
  - mtfconsole
  - nmap
module: Assessment Methodologies
topic: Enumeration
date: 2025-10-15
status: in-progress
---
# Objective

Answer the following questions:

1. Find the default tcp ports used by smbd.
2. Find the default udp ports used by nmbd.
3. What is the workgroup name of samba server?
4. Find the exact version of samba server by using appropriate nmap script.
5. Find the exact version of samba server by using smb_version metasploit module.
6. What is the NetBIOS computer name of samba server? Use appropriate nmap scripts.
7. Find the NetBIOS computer name of samba server using nmblookup
8. Using smbclient determine whether anonymous connection (null session) is allowed on the samba server or not.
9. Using rpcclient determine whether anonymous connection (null session) is allowed on the samba server or not.

# Walkthrough

- Ran `ifconfig` and `ping -c 1 demo.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines are in the same subnet

  <img width="770" height="390" alt="3-5  Samba Recon Basics ifconfig" src="https://github.com/user-attachments/assets/c39e8cf7-47c1-40d2-af0c-916c122760b6" />
  <img width="810" height="196" alt="3-5  Samba Recon Basics ping" src="https://github.com/user-attachments/assets/64c743d3-f5a3-4f47-84b6-72376a95f2b8" />

- Use nmap to do port and service scans:
	- `nmap -sS -sV -F -T4 192.196.28.3 -oX target_tcp.xml`

	  <img width="963" height="327" alt="3-5  Samba Recon Basics tcp port scan" src="https://github.com/user-attachments/assets/6e779cd7-0ef9-4469-8476-cfb8073fe290" />

	- `nmap -sU -sV -p 1-250 192.196.28.3 -oX target_udp.xml`

    <img width="989" height="463" alt="3-5  Samba Recon Basics udp scan" src="https://github.com/user-attachments/assets/14d573a0-b2cd-4a53-8258-eb8e2e1fd038" />

- Use `smb-os-discovery` nmap script to check the smb server version, `nmap -sS -sV -p 139,445 -T4 192.196.28.3 --script=smb-os-discovery`

  <img width="1030" height="531" alt="3-5  Samba Recon Basics smb-os-discovery" src="https://github.com/user-attachments/assets/d0429313-2e34-40d8-b4a3-9d9a46d2ae47" />

- msfconsole launch and initial setup

  <img width="1098" height="568" alt="3-5  Samba Recon Basics msf setup" src="https://github.com/user-attachments/assets/8e11b59e-cc2f-4185-b538-2305a978b1b0" />

- Use `smb_version` module to confirm the exact service version. The screenshot shows the module checked smb service on port 445, which could be the default port of the module configuration

  <img width="1461" height="728" alt="3-5  Samba Recon Basics smb version" src="https://github.com/user-attachments/assets/1a2a06fb-9afc-4de1-afd9-1cd3eeb0143c" />

- As we previously noticed that the smb service is also running on port 139, so we try setting RPORT to 139 and run the module again.

  <img width="1476" height="197" alt="3-5  Samba Recon Basics smb version 2" src="https://github.com/user-attachments/assets/efb7d86c-9147-4250-8bc4-fcf9e9385ec8" />

- Use `nmblookup -A 192.196.28.3` to check NetBIOS computer name of samba server

  <img width="1374" height="538" alt="3-5  Samba Recon Basics nmblookup" src="https://github.com/user-attachments/assets/425ccfc6-cc4b-417e-aaad-84b6187349b1" />

- Ran `smbclient -L 192.196.28.3 -N` to confirmed that the samba server allow anonymous connection

  <img width="917" height="442" alt="3-5  Samba Recon Basics smbclient" src="https://github.com/user-attachments/assets/ec498e58-1f9e-42cf-97d5-aac14087c7ad" />

- Ran `rpcclient -U "" -N 192.196.28.3` to confrom that the samba server allow anonymous connection

  <img width="856" height="96" alt="3-5  Samba Recon Basics rpcclient" src="https://github.com/user-attachments/assets/f55781ed-8c5c-4b69-9f09-8165ce738421" />

# Key Finds

- Why the lab requires us to use tools that was not introduced in the lecture at all?
