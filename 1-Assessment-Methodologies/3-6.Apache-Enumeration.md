---
tags:
  - "lab"
  - red_team
  - enumeration
  - T1046
  - msfconsole
module: Assessment Methodologies
topic: Enumeration
date: 2025-10-16
status: completed
---
# Objective

Run the following auxiliary modules against the target (victim-1):

- auxiliary/scanner/http/apache_userdir_enum
- auxiliary/scanner/http/brute_dirs
- auxiliary/scanner/http/dir_scanner
- auxiliary/scanner/http/dir_listing
- auxiliary/scanner/http/http_put
- auxiliary/scanner/http/files_dir
- auxiliary/scanner/http/http_login
- auxiliary/scanner/http/http_header
- auxiliary/scanner/http/http_version
- auxiliary/scanner/http/robots_txt

# Walkthrough

- Ran `ifconfig` and `ping -c 1 demo.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines are in the same subnet

  <img width="741" height="381" alt="3-6  Apache Enumeration if config" src="https://github.com/user-attachments/assets/1d275e16-ac0a-4c6d-9924-d0853b5f49fc" />
  <img width="719" height="206" alt="3-6  Apache Enumeration ping" src="https://github.com/user-attachments/assets/f00ab203-d7a0-43ed-8677-2911987f779b" />

- Use nmap to do port and service scanning in port 80 of the victim machine, `nmap -sS -p 80 192.70.43.3 -oX victim.xml`

  <img width="691" height="261" alt="3-6  Apache Enumeration nmap" src="https://github.com/user-attachments/assets/d4aa310d-9392-4159-a26c-e07835700a66" />

- Launch msfconsole and do initial setup

  <img width="558" height="399" alt="3-6  Apache Enumeration setup" src="https://github.com/user-attachments/assets/0eb3c655-8692-4e3d-a4a3-aa1b058c728a" />

- Use `auxiliary/scanner/http/http_version` to check the HTTP version

  <img width="782" height="194" alt="3-6  Apache Enumeration version" src="https://github.com/user-attachments/assets/5646e6f7-aab7-40ef-99b6-52f9cd855909" />

- Use `auxiliary/scanner/http/robots_txt` to check the robots.txt of the site.
  
  <img width="626" height="288" alt="3-6  Apache Enumeration robots" src="https://github.com/user-attachments/assets/a6d76674-c195-4002-9c92-811491d8bada" />

- Check the diretories disclosed by robots.txt with `curl` command

  <img width="1495" height="445" alt="3-6  Apache Enumeration curl 1" src="https://github.com/user-attachments/assets/8a70ae0a-496d-4243-8dac-a91322742d85" />
  <img width="829" height="375" alt="3-6  Apache Enumeration curl 2" src="https://github.com/user-attachments/assets/50430089-d29a-4a02-8407-d5aa4f75eb42" />

- We use `auxiliary/scanner/http/dir_listing` module to identify directory listing vulnerabilities in `/data`. There's directory listing, though, as our `curl` commands returned results, no files under it.

  <img width="750" height="240" alt="3-6  Apache Enumeration directory listing" src="https://github.com/user-attachments/assets/6e14744b-791a-408c-a9bc-eebd82f49f7c" />

- Now we use `auxiliary/scanner/http/http_put` module to test if we upload a file into the site. 

  <img width="834" height="383" alt="3-6  Apache Enumeration upload" src="https://github.com/user-attachments/assets/b071354f-c53a-4bc7-9f76-ba521b28942a" />

- Now we try it again to delete the file.

  <img width="1493" height="633" alt="3-6  Apache Enumeration delete" src="https://github.com/user-attachments/assets/2a5bdbed-cea5-4083-9d77-7dacafb6f689" />

- We are also interested with `secure`. Use `auxiliary/scanner/http/http_header` to check out its HTTP header.

  <img width="1489" height="728" alt="3-6  Apache Enumeration header" src="https://github.com/user-attachments/assets/28ddbaaa-e1ad-405e-830c-885ee439cdee" />

- From the headers we know that HTTP Basic Authentication is enabled in the page, which is not safe and can be potentially broken with brute force attack. So we gonna use `auxiliary/scanner/http/http_login` to try. And we found usable credential for the web authentication.

  <img width="802" height="322" alt="3-6  Apache Enumeration credentials" src="https://github.com/user-attachments/assets/d8e6011c-17b3-4f1e-b173-e351ddbb1532" />

- Also we want to know more potentially interesting directories in the site:
	- Use `auxiliary/scanner/http/brute_dirs` module. Nothing found.

	  <img width="814" height="542" alt="3-6  Apache Enumeration directory scanner" src="https://github.com/user-attachments/assets/f02ad325-68b1-4ed9-b4a7-ba23ad65d26a" />

	- Use `auxiliary/scanner/http/brute_dirs` module. Two directories found.

    <img width="645" height="200" alt="3-6  Apache Enumeration directory brute force" src="https://github.com/user-attachments/assets/7c87d5c7-90ac-4b29-9e17-4d2d2ea5234c" />

- Next we will use `auxiliary/scanner/http/files_dir` module to see if there's any interesting files exposed in the site. For those returns 301, we can potentially, not 1-% though, access them with the credential we found.

  <img width="884" height="755" alt="3-6  Apache Enumeration file 1" src="https://github.com/user-attachments/assets/a77bec7f-6e1a-49e6-a71d-cbf93dda8ab0" />
  <img width="966" height="756" alt="3-6  Apache Enumeration file 2" src="https://github.com/user-attachments/assets/f16e8c9f-5f89-4657-991e-0d6fdddb2fb5" />

- Now we use `auxiliary/scanner/http/apache_userdir_enum` module to determine if there are more potential usernames exist on the server.

  <img width="1491" height="707" alt="3-6  Apache Enumeration users" src="https://github.com/user-attachments/assets/79466ff8-0cc9-4d45-a586-b843fac23ca8" />
  
# Key Finds

- The server's 80 port is running Apache 2.4.18 on Ubuntu, which is vulnerable
- The server contains /secure directory, which can be accessed by authentication with weak credential, `bob:123321`
- The server contains several interesting files that are exposed to the public
- The /data/ directory allows attackers to upload and delete files to change the web content
- Some other directories found, but some of them requires authentication, which can be juicy target in the further activities
- More usernames on the server have been found.

# Lessons Learnt

- **Methodological Mindset**
	- **Phase 1: Baseline Intelligence & Target Identification**
		- **Question:** What am I even looking at? Is this a web server? What kind? What version?
	    - **Tool Selection:** The most direct tool to answer this is `auxiliary/scanner/http/http_version`. I run it.
	    - **Result:** It's an Apache server.
	- **Phase 2: Attack Surface Mapping**
		- **Question:** Now that I know it's Apache, what are its "doors and windows"? What directories, files, and endpoints are available? I need a map of the terrain.
	    - **Tool Selection:** The best tools for this are directory and file scanners. I'll choose `auxiliary/scanner/http/robots_txt` ,`auxiliary/scanner/http/dir_scanner` and `auxiliary/scanner/http/files_dir`. I'm not looking for vulnerabilities yet; I'm just building my map.   
		- **Result:** I find a `/cgi-bin/` directory and a few other interesting pages. I find `/secure/` directory, and it has HTTP Basic Authentication enabled.
	- **Phase 3: Hypothesis Formulation & Targeted Enumeration**
		- **Question:** Based on my map, where are the most likely weaknesses?
	    - **Hypothesis A:** Apache servers sometimes have a misconfiguration called "user directories" enabled. I should check for that specifically.
	    - **Tool Selection for A:** `auxiliary/scanner/http/apache_userdir_enum`.
	    - **Hypothesis B:** The `/cgi-bin/` directory is historically a source of vulnerabilities. I should check if any common CGI exploits work here.
	    - **Tool Selection for B:** `auxiliary/scanner/http/cgi_exec`.
	    - **Hypothesis C**: The authentication control on `/secure/` is weak. I should check if I can get any usable credentials by brute forcing.
	    - **Tool Selection for C**: `auxiliary/scanner/http/http_login`
