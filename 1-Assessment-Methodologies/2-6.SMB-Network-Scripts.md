---
tags:
  - "lab"
  - red_team
  - T1018
  - T1046
topic: Footprinting & Scanning
date: 2025-10-14
module: Assessment Methodologies
status: completed
---
# Objective

Your task is to fingerprint the service using the tools available on the Kali machine and run Nmap scripts to enumerate the Windows target machine's SMB service.

1. Identify SMB Protocol Dialects
2. Find SMB security level information
3. Enumerate active sessions, shares, Windows users, domains, services, etc.

# Walkthrough

- Ran `ifconfig` and `ping -c 1 demo.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and reachable
	- The machines are not in the same subnet

  <img width="1032" height="522" alt="2-6  SMB Network Scripts ifconfig" src="https://github.com/user-attachments/assets/47bc5637-e4a3-4a2b-9448-9df62e4c4998" />
  <img width="1076" height="259" alt="2-6  SMB Network Scripts ping" src="https://github.com/user-attachments/assets/85f37cc2-6457-4cb0-b21a-ccb8197a5a77" />

- Ran a initial and fast SYN port and service scan, `nmap -Pn -sS -sV -F demo.ine.local`. And we can see SMB (microsoft-ds) is running on an open port, tcp 445.

  <img width="1253" height="589" alt="2-6  SMB Network Scripts scan" src="https://github.com/user-attachments/assets/bfbf62ea-f361-4443-9d44-1a31f56c9ddf" />

- Ran my lazy NSE command against SMB service, `nmap -Pn -sS -sV -p 445 --script=smb* demo.ine.local`, and obtained the following information:

  <img width="1024" height="668" alt="2-6  SMB Network Scripts smb 1" src="https://github.com/user-attachments/assets/3e19b01d-ce1c-4b7f-bb8e-4f9cd64c9961" />
  <img width="725" height="722" alt="2-6  SMB Network Scripts smb 2" src="https://github.com/user-attachments/assets/76879e99-762a-4ca5-a953-0df21984fa26" />
  <img width="1059" height="545" alt="2-6  SMB Network Scripts smb 3" src="https://github.com/user-attachments/assets/d3eb829a-27b1-4a0a-b696-8e59bf053be9" />
  <img width="1169" height="481" alt="2-6  SMB Network Scripts smb 4" src="https://github.com/user-attachments/assets/33dd3809-d23e-4b32-8765-4efc06d0786c" />
  <img width="734" height="449" alt="2-6  SMB Network Scripts smb 5" src="https://github.com/user-attachments/assets/71256f85-9389-4464-8c3f-74777b8652e5" />
  <img width="727" height="427" alt="2-6  SMB Network Scripts smb 6" src="https://github.com/user-attachments/assets/3fcd6dd2-1bb7-423c-ad11-fc64cffb0b00" />

- For some reason, we didn't get the information of Windows users, domains, services from previous command execution, so we gonna run specific scripts manually. As the first step, I checked the potentially useful scripts first:

  <img width="990" height="282" alt="2-6  SMB Network Scripts NSE" src="https://github.com/user-attachments/assets/8f5ed1dc-2e72-4ba2-be2f-e7bc4bc35dca" />

- Ran the commands:
	- `nmap -Pn -sS -sV -p 445 --script==smb-enum-domains demo.ine.local`. Per results returned, it seems that the script failed to launch. Checked `nmap --script-help=smb-enum-domain` and it said `This generally requires credentisl`, so we will re-run the command with credentials provided.

    <img width="1390" height="699" alt="2-6  SMB Network Scripts smb domains 1" src="https://github.com/user-attachments/assets/8b212e10-6371-4487-8069-fc7c6e0d67b6" />

	- `nmap -Pn -sS -sV -p 445 --script==smb-enum-domains demo.ine.local --script-args smbusername=administrator,smbpassword=smbserver_771`. 

	  <img width="1485" height="598" alt="2-6  SMB Network Scripts smb domains 2" src="https://github.com/user-attachments/assets/bee9a58c-4e0d-4dca-b758-2e95094e3bde" />

	- `nmap -Pn -sS -sV -p 445 --script==smb-enum-groups demo.ine.local --script-args smbusername=administrator,smbpassword=smbserver_771`

	  <img width="1041" height="757" alt="2-6  SMB Network Scripts smb groups" src="https://github.com/user-attachments/assets/17e5a649-f71f-46ed-8466-b8adbd69e8a4" />

	- `nmap -Pn -sS -sV -p 445 --script==smb-enum-services demo.ine.local --script-args smbusername=administrator,smbpassword=smbserver_771

    <img width="1139" height="753" alt="2-6  SMB Network Scripts smb services 1" src="https://github.com/user-attachments/assets/a35b9c7a-cdb3-4070-90bb-3eaf6a26191b" />
    <img width="802" height="699" alt="2-6  SMB Network Scripts smb services 2" src="https://github.com/user-attachments/assets/c9125a0d-02c0-4125-b122-7650a078cef4" />
    <img width="818" height="700" alt="2-6  SMB Network Scripts smb services 3" src="https://github.com/user-attachments/assets/9d3417dc-2e18-4253-b8a6-bafd7db3978e" />

# Key Finds

See details in the screenshots
