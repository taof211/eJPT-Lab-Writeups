---
tags:
  - "lab"
  - T1046
module: Assessment Methodologies
topic: Enumeration
date: 2025-10-14
status: completed
---
# Objective

- Identify the ports open on the second target machine using appropriate Metasploit modules. 
- Write a bash script to scan the ports of the second target machine. 
- Upload the nmap static binary to the target machine and identify the services running on the second target machine.

# Walkthrough

- Ran `ifconfig` and `ping -c 1 demo1.ine.local` commands to identify the network information of the attack machine and the victim machine. Confirmed:
	- The IP addresses of both the machines
	- The target machine is online and pingable
	- The machines are in the same subnet

  <img width="1109" height="521" alt="3-3  T1046 Network Service Scanning ifconfig" src="https://github.com/user-attachments/assets/7a8e2551-7b9a-4518-94ef-9836e89da03d" />
  <img width="1092" height="260" alt="3-3  T1046 Network Service Scanning ping t1" src="https://github.com/user-attachments/assets/a9efae69-ec80-431e-83e7-de6a32b5e9e9" />

- Ran initial scan with NMAP, `nmap -A -T4 192.120.32.3 -oX target_1.xml`

  <img width="1033" height="756" alt="3-3  T1046 Network Service Scanning scan" src="https://github.com/user-attachments/assets/3bd0013d-aaa9-4a4f-9e5d-9b29fd6bcfa7" />

- Launch msfconsole and import the nmap scan results

  <img width="1017" height="681" alt="3-3  T1046 Network Service Scanning msf initial" src="https://github.com/user-attachments/assets/589c7bbe-0bc2-4361-8a35-ab8d86237ff2" />

- Ran `curl demo1.ine.local` and identify XODA app is running on the site from the source code

  <img width="1505" height="750" alt="3-3  T1046 Network Service Scanning curl" src="https://github.com/user-attachments/assets/26e2ebb9-8153-4d03-a9b4-a91b0271f68c" />

- Found and choose potentially usable exploit module, `xoda_file_upload`

  <img width="1496" height="487" alt="3-3  T1046 Network Service Scanning xoda" src="https://github.com/user-attachments/assets/bf627db8-e04c-4c88-9628-786dcef6d6a8" />

- Set options properly
  
  <img width="1458" height="730" alt="3-3  T1046 Network Service Scanning xoda options" src="https://github.com/user-attachments/assets/ed4a9024-4355-4a07-a349-2be2fbacafd0" />

- Ran Exploit and session established

  <img width="1474" height="271" alt="3-3  T1046 Network Service Scanning xoda run" src="https://github.com/user-attachments/assets/ff48288c-3d30-42e8-90c1-6b344de1d279" />
  <img width="1474" height="155" alt="3-3  T1046 Network Service Scanning session t1" src="https://github.com/user-attachments/assets/7e2bf503-b23d-40fb-a43a-4e9d4b4b1559" />

- Drop into the system bash shell and check network configuration, and identified another IP (eth1) 192.22.110.2

  <img width="1132" height="708" alt="3-3  T1046 Network Service Scanning shell t1" src="https://github.com/user-attachments/assets/69489541-ef8e-4786-bba8-e7854a76dae5" />

- Ran `run autoroute -s 192.22.110.0`

  <img width="1097" height="219" alt="3-3  T1046 Network Service Scanning autoroute-1" src="https://github.com/user-attachments/assets/71e55b46-561b-4e66-b624-ab78a103f8a8" />

- Send the session backgroup and back to MSF Console

  <img width="1471" height="401" alt="3-3  T1046 Network Service Scanning background t1" src="https://github.com/user-attachments/assets/40c0e42e-a48d-412e-84fc-de8fda8f7639" />

- Use and run `ping_sweep for host discovery, and found the IP of the second target, 192.22.110.3

  <img width="1167" height="669" alt="3-3  T1046 Network Service Scanning ping sweep" src="https://github.com/user-attachments/assets/36b340ab-9e21-4fe5-a171-422ab0aa8ff6" />

- Use `/portscan/syn` and set options properly

  <img width="1481" height="689" alt="3-3  T1046 Network Service Scanning port_scan" src="https://github.com/user-attachments/assets/dc27eb5e-1f1f-4f75-b8c0-9860ccc8de15" />

- `/portscan/syn` didn't find anything. Switching to `/portscan/tcp` to try again, and found three open ports

  <img width="970" height="277" alt="3-3  T1046 Network Service Scanning tcp scan" src="https://github.com/user-attachments/assets/8625374a-02b2-4cd5-b0a7-aff62fc9c007" />

- Create the following bash script and store it in /root/script.sh

```bash
#!/bin/bash
for port in {1..1000}; do
 timeout 1 bash -c "echo >/dev/tcp/$1/$port" 2>/dev/null && echo "port $port is open"
done
```

- Upload both the nmap binary and the script into target 1

<img width="1110" height="244" alt="3-3  T1046 Network Service Scanning upload tools" src="https://github.com/user-attachments/assets/6af40622-5a69-4011-a9ca-3eddba172eec" />

- Enter shell of target 1 and assign execution permission to the two files uploaded

  <img width="962" height="295" alt="3-3  T1046 Network Service Scanning permission" src="https://github.com/user-attachments/assets/5a08fdc8-02d3-4019-aef2-50b5624a7c45" />

- Ran the tools as required

  <img width="735" height="148" alt="3-3  T1046 Network Service Scanning script running" src="https://github.com/user-attachments/assets/32a2a8d4-89f9-46fe-8bcf-66d1e7562f62" />
  <img width="987" height="422" alt="3-3  T1046 Network Service Scanning binary run" src="https://github.com/user-attachments/assets/a8b023e1-fe6f-46fb-be94-5faff1cc01d4" />


# Key Finds

- There are three open ports in target 2 machin
